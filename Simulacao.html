<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Gabriel Agostini Orso" />


<title>Geração de Números Aleatórios</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="ggplot.html">ggplot</a>
</li>
<li>
  <a href="MQO.html">MQO</a>
</li>
<li>
  <a href="dplyr.html">dplyr</a>
</li>
<li>
  <a href="Simulacao.html">Simulação</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gabrielorso/gabrielorso.github.io">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Geração de Números Aleatórios</h1>
<h4 class="author">Gabriel Agostini Orso</h4>

</div>


<div id="introdução" class="section level1" number="1">
<h1><span class="header-section-number">1</span> INTRODUÇÃO</h1>
<p>Esse trabalho foi requisito para aprovação na disciplina <strong>CE089 - Estatística Computacional II</strong>, ofertada para o curso de Estatística da Universidade Federal do Paraná, e ministrada pelos professores Paulo Justiniano Ribeiro Júnior e Walmes Zeviani. O objetivo do trabalho foi gerar amostras aleatórias de uma certa distribuição de probabilidade com um parâmetro <span class="math inline">\(\theta\)</span>, e a partir dessas amostras realizar a estimativa pontual e intervalar de <span class="math inline">\(\hat{\theta}\)</span> via máxima verossimilhança, jackknife e bootstrap.</p>
<hr />
<p>Em linhas gerais, esses são os principais pontos do trabalho, que eu gostaria que o leitor se atentasse para os seguintes pontos:</p>
<ul>
<li><p>A geração de números aleatórios a partir do algoritmo de Metropolis-Hastings</p></li>
<li><p>O tamanho do intervalo de confiança é diferente para diferentes valores de <span class="math inline">\(\theta\)</span></p></li>
<li><p>O intervalo de confiança diminui à medida que aumenta o tamanho da amostra</p></li>
</ul>
<hr />
<p>A distribuição de probabilidade escolhida foi</p>
<span class="math display" id="eq:f">\[\begin{equation}
F(x) = 1-e^{-x^2 \over 2\theta^2} \quad , \quad x &gt; 0 , \enspace  \theta &gt; 0
\tag{1.1}
\end{equation}\]</span>
<p>Veja que <a href="#eq:f">(1.1)</a> já é a distribuição acumulada de <span class="math inline">\(x\)</span>. Já a densidade pode ser obtida derivando a função em relação a <span class="math inline">\(x\)</span>:</p>
<span class="math display" id="eq:fder">\[\begin{equation}
f(x) = {dF(x) \over dx} = {d \over dx} \Big[1-e^{-x^2 \over 2\theta^2} \Big] =  {x e^{ {-x^2 \over 2\theta^2}} \over \theta^2}
\tag{1.2}
\end{equation}\]</span>
<p>Na <a href="#fig:f2">1.1</a> estão apresentadas as curvas de densidade e acumuladas da distribuição escolhida para diferentes valores do parâmetro <span class="math inline">\(\theta\)</span>.</p>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:f2"></span>
<img src="Simulacao_files/figure-html/f2-1.png" alt="Possíveis parametrizações da distribuição de probabilidade." width="768" />
<p class="caption">
Figure 1.1: Possíveis parametrizações da distribuição de probabilidade.
</p>
</div>
<p>Veja que nosso objetivo é gerar valores de <span class="math inline">\(x\)</span> pertencentes à essa distribuição com um determinado valor de <span class="math inline">\(\theta\)</span> fixado, e a partir dessa amostra de <span class="math inline">\(x\)</span> <em>encontrar o valor de <span class="math inline">\(\theta\)</span> que foi usado para gerar esses dados</em>, denotado por <span class="math inline">\(\hat{\theta}\)</span>. Portanto <span class="math inline">\(\theta\)</span> se refere ao valor paramétrico, verdadeiro, aquele que gerou os dados, e <span class="math inline">\(\hat{\theta}\)</span> é a nossa estimativa do valor verdadeiro a partir dos dados. Como é uma estimativa, há uma incerteza associada à essa estimativa. Essa incerteza é a base dos intervalos de confiança.</p>
<p>Vamos tentar estimar o parâmetro <span class="math inline">\(\theta\)</span> e sua incerteza a partir de três métodos. O primeiro é a partir da máxima verossimilhança, o segundo a partir de jackknife, e o terceiro a partir de bootstrap. Também vamos repetir esse experimento inúmeras vezes e avaliar o comportamento da estimativa para um grande número de repetições, o que também caracteriza esse trabalho como um estudo de Monte Carlo.</p>
<hr />
<div id="gerador-de-números-aleatórios" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Gerador de números aleatórios</h2>
<p>Como gerar números aleatórios dessa distribuição? no R, diversas distribuições de probabilidade possuem geradores de números aleatórios já implementados no pacote base: <code>rnorm()</code>, <code>rexp()</code>, <code>rchisq()</code>, etc. A distribuição desse trabalho, no entanto, não possui tal função implementada, e vamos utilizar um algoritmo chamado Metropolis-Hastings para amostrar dessa distribuição. Tudo que precisamos é a função densidade <a href="#eq:fder">(1.2)</a>.</p>
<p>De uma maneira resumida, o algoritmo de Metropolis-Hastings usa uma outra distribuição de probabilidade (chamada de <em>proposal</em>) para gerar amostras da distribuição desejada. Se certas condições forem satisfeitas, <a href="http://cursos.leg.ufpr.br/ce089/08_MCMC.html">com o tempo esse processo irá convergir para a distribuição estacionária de uma cadeia de Markov</a>, que não por acaso será a própria distribuição desejada. Veja que devemos ser capazes de gerar números aleatórios da <em>proposal</em> para que isso funcione. Aqui, utilizei uma distribuição qui-quadrado (<span class="math inline">\(\chi^2\)</span>) como <em>proposal</em>.</p>
<p>Como é uma cadeia de Markov que precisa entrar em estacionariedade, é comum no método “jogar fora” as amostras iniciais (burnin), de forma a só amostrar da distribuição quando o processo entrar em estacionariedade. Além disso, por ser um processo markoviano, cada amostra gerada não é independente da anterior, por isso também é comum aproveitar somente 1 a cada x amostras geradas (thinning) para amenizar essa dependência entre as observações.</p>
<p>Abaixo está minha implementação do algoritmo de Metropolis-Hastings para o problema.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proposal</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x, df, ...) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dchisq</span>(x, df, ...)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>rfun <span class="ot">&lt;-</span> <span class="cf">function</span>(n, theta, dprop, <span class="at">burnin =</span> <span class="dv">1000</span>, <span class="at">thinning =</span> <span class="dv">10</span>, <span class="at">x0 =</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    ...) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n: número de amostras geradas da distribuição</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theta: parâmetro da distribuição</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dprop: função densidade da distribuição proposta</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># burnin: número de amostras de aquecimento. O padrão é 1000</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># thinning: passo de seleção de amostras para amenizar a autocorrelação. O</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># padrão é 10</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x0: valor inicial da distribuição proposta. O padrão é rchisq(n = 1, df =</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...: demais argumentos passados para a função dprop</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">*</span> thinning <span class="sc">+</span> burnin)) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="fu">log</span>(<span class="fu">dfun</span>(y, theta)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">g</span>(x[i <span class="sc">-</span> <span class="dv">1</span>], y))) <span class="sc">-</span> (<span class="fu">log</span>(<span class="fu">dfun</span>(x[i <span class="sc">-</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>], theta)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">g</span>(y, x[i <span class="sc">-</span> <span class="dv">1</span>]))))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> alpha) {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    xn <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>burnin)]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    xn <span class="ot">&lt;-</span> xn[<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">length</span>(xn), thinning)]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mcmc =</span> xn, <span class="at">k =</span> k<span class="sc">/</span>(n <span class="sc">*</span> thinning <span class="sc">+</span> burnin)))</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Na Figura <a href="#fig:gna">1.2</a> há um exemplo comparando a distribuição teórica de parâmetro <span class="math inline">\(\theta = 40\)</span> com a distribuição empírica construída a partir de 10000 amostras geradas pelo algoritmo de Metropolis-Hastings. As curvas estão bem parecidas, então aparentemente o algoritmo funciona bem. O painel inferior direito da figura mostra a função de autocorrelação, e aparentemente um valor de raleio de 50 elimina a dependência entre observações.</p>
<p>Foi utilizado um burnin de 1000 amostras, e um thinning de 50. Isso quer dizer que as primeiras 1000 amostras geradas pelo algoritmo foram descartadas, e após isso, apenas uma amostra a cada 50 foi de fato utilizada. Em outras palavras, para ter uma amostra de tamanho 10000, precisamos gerar <span class="math inline">\(10000*50 + 1000 = 501000\)</span> valores da distribuição desejada.</p>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:gna"></span>
<img src="Simulacao_files/figure-html/gna-1.png" alt="Comparação entre curvas empírica e teórica da distribuição para uma amostra de tamanho 10000." width="960" />
<p class="caption">
Figure 1.2: Comparação entre curvas empírica e teórica da distribuição para uma amostra de tamanho 10000.
</p>
</div>
<hr />
</div>
</div>
<div id="estimando-theta" class="section level1" number="2">
<h1><span class="header-section-number">2</span> ESTIMANDO <span class="math inline">\(\theta\)</span></h1>
<div id="estimador-de-máxima-verossimilhança" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Estimador de máxima verossimilhança</h2>
<p>Para estimar <span class="math inline">\(\hat{\theta}\)</span> a partir dos dados, usarei o estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span>. O método de máxima verossimilhança basicamente nos responde a seguinte questão: dado que esses são os dados, qual seria o valor de <span class="math inline">\(\theta\)</span> <em>que torna mais provável a geração desses dados</em>? Mais informações podem ser obtidas <a href="http://www.leg.ufpr.br/~wagner/MCIE/Tutorial/TutorialII.html">aqui</a>.</p>
<p>As funções de verissimilhança <span class="math inline">\(L(x)\)</span> e log-verossimilhança <span class="math inline">\(lL(x)\)</span> são escritas como</p>
<span class="math display">\[\begin{equation}
L(x|\theta) = \displaystyle\prod_{i=1}^{n} { x_i e^{-x^2_i \over 2\theta^2} \over \theta^2} = {\displaystyle \prod_{i=1}^n x_i e^{-x^2_i \over 2\theta^2} \over \theta^{2n}}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\label{eq:lL}
lL(\theta | x) = log(L(x|\theta)) = \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\theta^2} - 2n log(\theta)
\end{equation}\]</span>
<p>O estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span> é obtido a partir da derivada de <span class="math inline">\(lL(x)\)</span> em relação à <span class="math inline">\(\theta\)</span> e igualando a derivada a 0.</p>
<p><span class="math display">\[
U(\theta) = {d \over d\theta} [lL(\theta | x)] = {\displaystyle\sum_{i=1}^n x^2_i \over \theta^3} - {2n \over \theta}
\]</span></p>
<p><span class="math display">\[
{\displaystyle\sum_{i=1}^n x^2_i \over \hat{\theta}^3} - {2n \over \hat{\theta}} = 0
\]</span></p>
<span class="math display" id="eq:esttheta">\[\begin{equation}

\hat{\theta} = \Bigg( {\displaystyle\sum_{i=1}^n x^2_i \over 2n } \Bigg)^{1 \over 2}
\tag{2.1}
\end{equation}\]</span>
<p>Ou seja, dado meu conjunto de dados <span class="math inline">\(x\)</span>, <a href="#eq:esttheta">(2.1)</a> é o estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span>. Abaixo está sua implementação em R. Usarei essa função para estimar <span class="math inline">\(\hat{\theta}\)</span> ao longo do trabalho.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>esttheta <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, ...) (<span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(amostra)))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="variância-do-estimador-de-máxima-verossimilhança" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Variância do estimador de máxima verossimilhança</h2>
<p>A Variância do estimador é definida como <span class="math inline">\(V(\theta) = -I(\theta)^{-1}\)</span>. A informação observada de Fisher para essa distribuição é dada por</p>
<p><span class="math display">\[
I(\theta) = {d \over d\theta} [U(\theta)] = {-3\displaystyle \sum_{i=1}^n x^2_i \over \theta^4} + {2n \over \theta^2} = {-3\displaystyle\sum_{i=1}^n x^2_i + 2n\theta^2 \over \theta^4}
\]</span></p>
<span class="math display" id="eq:var">\[\begin{equation}
V(\theta) = -I(\theta)^{-1} =  -\Bigg( {-3\displaystyle\sum_{i=1}^n x^2_i + 2n\theta^2 \over \theta^4}  \Bigg)^{-1} = { \theta^4 \over 3\displaystyle\sum_{i=1}^n x^2_i - 2n\theta^2 }
\tag{2.2}
\end{equation}\]</span>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vartheta <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, that, ...) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    that<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">3</span> <span class="sc">*</span> <span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(amostra) <span class="sc">*</span> that<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui utilizei a informação observada, e não esperada, de Fisher. De qualquer forma, a variância do estimador não foi utilizada, pois o intervalo de confiança foi construído a partir da Deviance, apresentada abaixo.</p>
</div>
<div id="intevalo-de-confiança-baseado-na-razão-de-verossimilhança" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Intevalo de confiança baseado na razão de verossimilhança</h2>
<p>A deviance pode ser escrita como <span class="math inline">\(D(\theta) = -2log\big({L(\theta|x) \over L(\hat{\theta}|x)}\big)\)</span>, tal que <span class="math inline">\(D(\theta) \sim \chi^2_1\)</span>.</p>
<p><span class="math display">\[
D(\theta) = -2log\Bigg({L(\theta|x) \over L(\hat{\theta}|x)}\Bigg) = -2\Big[ lL(\theta) - lL(\hat{\theta}) \Big] =
\]</span></p>
<p><span class="math display">\[
-2 \Bigg[ \displaystyle \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\theta^2} - 2nlog(\theta) - \Bigg( \displaystyle \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\hat{\theta}^2} - 2nlog(\hat{\theta}) \Bigg) \Bigg] =
\]</span></p>
<p><span class="math display">\[
-2 \Bigg[ {\displaystyle\sum_{i=1}^n x^2_i \over 2\hat{\theta}^2} - {\displaystyle\sum_{i=1}^n x^2_i \over 2\theta^2} + 2nlog(\hat{\theta}) - 2nlog(\theta)  \Bigg] = -2\Bigg[ {\displaystyle\sum_{i=1}^n x^2_i \over 2} \Bigg({1 \over \hat{\theta}^2} - {1 \over \theta^2} \Bigg) + 2nlog\Bigg({\hat{\theta} \over \theta} \Bigg) \Bigg]
\]</span></p>
<span class="math display" id="eq:deviance">\[\begin{equation}
D(\theta) = \displaystyle\sum_{i=1}^n x^2_i \Bigg( {1 \over \theta^2} - {1 \over \hat{\theta}^2} \Bigg) - 4nlog\Bigg( {\hat{\theta} \over \theta} \Bigg)
\tag{2.3}
\end{equation}\]</span>
<p>Portanto os valores de <span class="math inline">\(\theta\)</span> que resultem em um valor extremo de <span class="math inline">\(D(\theta)\)</span> (sabendo que <span class="math inline">\(D(\theta) \sim \chi^2_1\)</span>), serão valores não contidos pelo intervalo de confiança (Figura <a href="#fig:deviance">2.1</a>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>devtheta <span class="ot">&lt;-</span> <span class="cf">function</span>(t, that, amostra, ...) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>t<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>that<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">length</span>(amostra) <span class="sc">*</span> <span class="fu">log</span>(that<span class="sc">/</span>t)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">50</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">devtheta</span>(x, <span class="at">that =</span> <span class="dv">40</span>, <span class="fu">rfun</span>(<span class="dv">30</span>, <span class="dv">40</span>, g)<span class="sc">$</span>mcmc), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">50</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Deviance&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 40&quot;</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">devtheta</span>(x, <span class="at">that =</span> <span class="dv">1</span>, <span class="fu">rfun</span>(<span class="dv">30</span>, <span class="dv">1</span>, g)<span class="sc">$</span>mcmc), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.5</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Deviance&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 1&quot;</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:deviance"></span>
<img src="Simulacao_files/figure-html/deviance-1.png" alt="Deviances para amostras de tamanho 30 utilizando valores de parâmetro 40 e 1. Os valores de theta cuja deviance esteja abaixo da linha vermelha estão contidos no intervalo de confiança." width="768" />
<p class="caption">
Figure 2.1: Deviances para amostras de tamanho 30 utilizando valores de parâmetro 40 e 1. Os valores de theta cuja deviance esteja abaixo da linha vermelha estão contidos no intervalo de confiança.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<hr />
</div>
</div>
<div id="estudo-do-viés-e-cobertura-de-ic-para-theta." class="section level1" number="3">
<h1><span class="header-section-number">3</span> ESTUDO DO VIÉS E COBERTURA DE IC PARA <span class="math inline">\(\theta\)</span>.</h1>
<p>Foram considerados 2 cenários para a simulação:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\theta = 40\)</span>;</p></li>
<li><p><span class="math inline">\(\theta = 1\)</span>.</p></li>
</ol>
<p>No entanto, em cada cenário foram geradas amostras aleatórias da distribuição escolhida de tamanhos 2 a 30, e depois de 50 a 1000 ao passo de 20, o que totaliza 77 tamanhos de amostra diferentes. De cada uma dessas amostras foram feitas a estimativa pontual do parâmetro (Equação <a href="#eq:esttheta">(2.1)</a>) e delimitação do intervalo de confiança utilizando máxima verossimilhança, jackknife e bootstrap. Além disso, cada uma dessas etapas foi repetida 100 vezes, a fim de avaliar a taxa real de cobertura dos intervalos de confiança por cada método para cada cenário.</p>
<p>A Figura <a href="#fig:densidades">3.1</a> apresenta a curva da densidade de probabilidade da função para os dois parâmetros escolhidos. Veja que quando <span class="math inline">\(\theta = 1\)</span>, a curva é muito mais assimétrica e com menor dispersão.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">40</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 1&quot;</span>), <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 40&quot;</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">text.col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">40</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>), <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="st">&quot;Densidade&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">add =</span> T)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 1&quot;</span>), <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">&quot; = 40&quot;</span>)),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:densidades"></span>
<img src="Simulacao_files/figure-html/densidades-1.png" alt="Densidade da distribuição para os dois parâmetros testados." width="768" />
<p class="caption">
Figure 3.1: Densidade da distribuição para os dois parâmetros testados.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(n, <span class="cf">function</span>(x) <span class="fu">rfun</span>(<span class="at">n =</span> x, <span class="at">theta =</span> par_C1, <span class="at">dprop =</span> g,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">thinning =</span> <span class="dv">50</span>)<span class="sc">$</span>mcmc))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(n, <span class="cf">function</span>(x) <span class="fu">rfun</span>(<span class="at">n =</span> x, <span class="at">theta =</span> par_C2, <span class="at">dprop =</span> g,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">thinning =</span> <span class="dv">50</span>)<span class="sc">$</span>mcmc))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativas de theta</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>that_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, esttheta))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>that_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, esttheta))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># médias de theta estimado para cada tamanho de amostra</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>media_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) that_C1[[y]][[x]])))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>media_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) that_C2[[y]][[x]])))</span></code></pre></div>
<p>Na Figura <a href="#fig:simulacoes">3.2</a> estão os valores estimados de <span class="math inline">\(\hat{\theta}\)</span> para cada tamanho de amostra e cada uma das 100 realizações de monte carlo. Os paineis à esquerda são um recorte dos da direita, limitando a um tamanho de amostra entre 2 e 30. Veja que conforme aumenta o tamanho de amostra, há uma redução da variabilidade de <span class="math inline">\(\hat{\theta}\)</span>. Ou seja, passamos a ser mais <em>confiantes</em> da nossa estimativa conforme aumenta o tamanho da amostra.</p>
<p>Veja que também que a dispersão das linhas para <span class="math inline">\(\theta = 40\)</span> é maior que quando <span class="math inline">\(\theta = 1\)</span>. Veja também que de acordo com a equação <a href="#eq:var">(2.2)</a>, a variância do estimador depende de seu valor. Portanto maiores valores de <span class="math inline">\(\theta\)</span> incorrem em uma maior variabilidade em torno de si.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], that_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, that_C1[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, media_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Média&quot;</span>, <span class="st">&quot;Parâmetro&quot;</span>, <span class="st">&quot;Simulações&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], that_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, that_C2[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, media_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:simulacoes"></span>
<img src="Simulacao_files/figure-html/simulacoes-1.png" alt="Estimativas de theta para cada tamanho de amostra e simulação de monte carlo." width="768" />
<p class="caption">
Figure 3.2: Estimativas de theta para cada tamanho de amostra e simulação de monte carlo.
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<div id="via-máxima-verossimilhança" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Via Máxima Verossimilhança</h2>
<p>A partir da função Deviance (Equação <a href="#eq:deviance">(2.3)</a>), podemos calcular o intervalo de confiança da nossa estimativa <span class="math inline">\(\hat{\theta}\)</span> para cada uma das 100 realizações de Monte Carlo. A Figura <a href="#fig:ICLL">3.3</a> mostra esses intervalos para a primeira realização de Monte Carlo. As barras vermelhas representam intervalos que não contiveram o valor verdadeiro (40 e 1, linha azul).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando máxima verossimilhança -----------</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>var_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">vartheta</span>(<span class="at">amostra =</span> C1[[y]][[x]],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">that =</span> that_C1[[y]][[x]])))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>var_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">vartheta</span>(<span class="at">amostra =</span> C2[[y]][[x]],</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">that =</span> that_C2[[y]][[x]])))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança de 95%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rootSolve)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>IC_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(j) {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(y) {</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        LI <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C1[[j]][[y]], <span class="at">amostra =</span> C1[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">lower =</span> <span class="fl">0.001</span>, <span class="at">upper =</span> that_C1[[j]][[y]])<span class="sc">$</span>root</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        LS <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C1[[j]][[y]], <span class="at">amostra =</span> C1[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">lower =</span> that_C1[[j]][[y]], <span class="at">upper =</span> <span class="dv">200</span>)<span class="sc">$</span>root</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">c</span>(LI, LS))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>IC_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(j) {</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(y) {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">uniroot.all</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C2[[j]][[y]], <span class="at">amostra =</span> C2[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="dv">5</span>))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>contem_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>contem_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)), <span class="at">bg =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>],</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">2</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;red&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>, <span class="at">xlab =</span> <span class="cn">NA</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>]), <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]],</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) x[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Média&quot;</span>, <span class="st">&quot;Parâmetro&quot;</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;blue&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>],</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">2</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;red&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>]), <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]],</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) x[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:ICLL"></span>
<img src="Simulacao_files/figure-html/ICLL-1.png" alt="Intervalos de confiança 95% para a primeira realização da simulação de monte carlo utilizando máxima verossimilhança." width="768" />
<p class="caption">
Figure 3.3: Intervalos de confiança 95% para a primeira realização da simulação de monte carlo utilizando máxima verossimilhança.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>Para cada intervalo de confiança dessas figuras, existem outros 99 intervalos construídos via simulação. Como os intervalos são de 95% de confiança, espera-se que 95% dessas 100 realizações contenham o valor verdadeiro. Isso se chama taxa de cobertura do intervalo de confiança (quanto ele realmente é confiável).</p>
<p>A Figura <a href="#fig:coberturaLL">3.4</a> apresenta a taxa de cobertura dos intervalos de confiança para os diferentes tamanhos de amostra. Aparentemente os intervalos possuem uma cobertura similar para todo os tamanhos de amostra, mas esse resultado não está muito de acordo com o que se vê na literatura, portanto deve ser verificado com mais calma.</p>
<div class="alert alert-danger" role="alert">
<p>
<strong>ATENÇÃO:</strong> Essa taxa de cobertura está estranha. a taxa de cobertura utilizando bootstrap é o comportamento esperado.
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cobertura_LL_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cobertura_LL_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_LL_C1, <span class="st">&quot;[[&quot;</span>, i)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_LL_C2, <span class="st">&quot;[[&quot;</span>, i)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    cobertura_LL_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(a)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    cobertura_LL_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b[validos_C2 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(b)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_LL_C1, <span class="at">main =</span> <span class="fu">c</span>(<span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_LL_C2, <span class="at">main =</span> <span class="fu">c</span>(<span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:coberturaLL"></span>
<img src="Simulacao_files/figure-html/coberturaLL-1.png" alt="Taxa de cobertura dos Intervalos de confiança utilizando máxima verossimilhança para cada tamanho de amostra após 1000 simulações de monte carlo." width="768" />
<p class="caption">
Figure 3.4: Taxa de cobertura dos Intervalos de confiança utilizando máxima verossimilhança para cada tamanho de amostra após 1000 simulações de monte carlo.
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>Já ná Figura <a href="#fig:ViesLL">3.5</a> está o viés de estimativa dos parâmetros para os diferentes tamanhos de amostra. Aparentemente não foi identificado nenhum viés no estimador (lembrando que o estimador de máxima verossimilhança é assintoticamente não viesado).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vies_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(that_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vies_medio_LL_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_LL_C1[[y]][[x]])))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>vies_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(that_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>vies_medio_LL_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_LL_C2[[y]][[x]])))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_LL_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_LL_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_LL_C1[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_LL_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Viés Médio&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Simulações&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_LL_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_LL_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_LL_C2[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_LL_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:ViesLL"></span>
<img src="Simulacao_files/figure-html/ViesLL-1.png" alt="Viés médio e de cada simulação de monte carlo a partir do estimador de máxima verossimilhança." width="768" />
<p class="caption">
Figure 3.5: Viés médio e de cada simulação de monte carlo a partir do estimador de máxima verossimilhança.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="via-jackknife" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Via Jackknife</h2>
<p>Seja uma amostra de tamanho <span class="math inline">\(n = 20\)</span> (<span class="math inline">\(x_1, x_2, ..., x_n\)</span>), e seja um parâmetro <span class="math inline">\(\hat{\theta}\)</span> estimado a partir dessas n amostras. A estimativa pontual jackknife consiste em retirar uma observação (a i-ésima) e estimar novamente o parâmetro com as 19 observações restantes, denotado por <span class="math inline">\(\hat{\theta}^{(i)}\)</span>. Repita esse passo retirando uma a uma todas as 20 observações.</p>
<p><span class="math display">\[
\hat{\theta} = f(x_1, x_2, ..., x_n)
\]</span></p>
<p><span class="math display">\[
\hat{\theta}^{(i)} = f(x_1, x_2, ..., x_{i-1}, x_{i+1}, ..., x_n)
\]</span></p>
<p>A seguir, estime os chamados pseudo valores, denotados por <span class="math inline">\(\hat{\theta}^{*(i)}\)</span>, da seguinte forma</p>
<p><span class="math display">\[
\hat{\theta}^{*(i)} = n . \hat{\theta} - (n-1) . \hat{\theta}^{(i)}
\]</span></p>
<p>O estimador pontual jackknife <span class="math inline">\(\hat{\theta}^*\)</span> será a média dos pseudo valores</p>
<p><span class="math display">\[
\hat{\theta}^* = {\displaystyle\sum_{i=1}^n \hat{\theta}^{*(i)} \over n}
\]</span></p>
<p>O erro padrao do estimador jackknife é dado por</p>
<p><span class="math display">\[
EP[\hat{\theta}^*] = \sqrt{Var[\hat{\theta}^*] \over n}
\]</span></p>
<p>e seu intervalo de confinça pode ser aproximado por uma distribuição t de student se considerarmos que os pseudo valores são independentes. Mais informações sobre jackknife podem ser encontradas <a href="http://cursos.leg.ufpr.br/ce089/11_jackknife.html">aqui</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>esttheta_jack <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, f, <span class="at">pseudo =</span> F, ...) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># amostra: vetor numérico com o conjunto de observações;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># f: função da estatística desejada para cálculo;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pseudo: lógico que indica se os pseudo valores devem ser retornados;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...: outros argumentos passados para f;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ---</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># value: se pseudo = F, uma lista contendo a estimativa pontual de</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Jackknife e a variância estimada do estimador de Jackknife. Se pseudo =</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># T, uma lista igual à anterior mas acrescida dos pseudo valores.</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(amostra)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    par <span class="ot">&lt;-</span> <span class="fu">f</span>(amostra, ...)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">sapply</span>(i, <span class="cf">function</span>(x) <span class="fu">f</span>(amostra[<span class="sc">-</span>x], ...), <span class="at">simplify =</span> T)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    pseudovalores <span class="ot">&lt;-</span> n <span class="sc">*</span> par <span class="sc">-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> val</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    est <span class="ot">&lt;-</span> <span class="fu">mean</span>(pseudovalores)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">var</span>(pseudovalores)<span class="sc">/</span><span class="fu">length</span>(pseudovalores)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pseudo) {</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">est =</span> est, <span class="at">var =</span> var, <span class="at">pseudo =</span> pseudovalores))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">est =</span> est, <span class="at">var =</span> var))</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando Jackknife --------------</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimativa pontual</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>est_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>est))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>est_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>est))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>var_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>var))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>var_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>var))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança de 95%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>IC_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(est, am, var) est <span class="sc">+</span> <span class="fu">c</span>(<span class="at">LI =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">LS =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(am) <span class="sc">-</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(var), <span class="at">est =</span> est_jack_C1[[x]], <span class="at">am =</span> C1[[x]], <span class="at">var =</span> var_jack_C1[[x]])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>IC_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(est, am, var) est <span class="sc">+</span> <span class="fu">c</span>(<span class="at">LI =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">LS =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(am) <span class="sc">-</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(var), <span class="at">est =</span> est_jack_C2[[x]], <span class="at">am =</span> C2[[x]], <span class="at">var =</span> var_jack_C2[[x]])</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>A <a href="#fig:estjack">3.6</a> apresenta os intervalos de confiança para uma das 100 realizações de Monte Carlo. A taxa de cobertura (Figura <a href="#fig:coberturajack">3.7</a>) mostra um padrão também não muito condizente com o que se vê na literatura.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>contem_C1_jack <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_jack_C1[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>contem_C2_jack <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_jack_C2[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_jack[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_jack_C1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_jack,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Média&quot;</span>, <span class="st">&quot;Parâmetro&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;blue&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_jack[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_jack_C2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_jack,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:estjack"></span>
<img src="Simulacao_files/figure-html/estjack-1.png" alt="Intervalos de confiança 95% utilizando jackknife para a primeira simulação de monte carlo." width="768" />
<p class="caption">
Figure 3.6: Intervalos de confiança 95% utilizando jackknife para a primeira simulação de monte carlo.
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<div class="alert alert-danger" role="alert">
<p>
<strong>ATENÇÃO:</strong> Essa taxa de cobertura está estranha. a taxa de cobertura utilizando bootstrap é o comportamento esperado.
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cobertura_jack_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cobertura_jack_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_jack_C1, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_jack_C2, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    cobertura_jack_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(a)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    cobertura_jack_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(b)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_jack_C1, <span class="at">main =</span> <span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_jack_C2, <span class="at">main =</span> <span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:coberturajack"></span>
<img src="Simulacao_files/figure-html/coberturajack-1.png" alt="Taxa de cobertura de IC utilizando jackknife para 1000 simulações de monte carlo." width="768" />
<p class="caption">
Figure 3.7: Taxa de cobertura de IC utilizando jackknife para 1000 simulações de monte carlo.
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>vies_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_jack_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>vies_medio_jack_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_jack_C1[[y]][[x]])))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>vies_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_jack_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>vies_medio_jack_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_jack_C2[[y]][[x]])))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_jack_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_jack_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_jack_C1[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_jack_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Viés Médio&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Simulações&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_jack_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_jack_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_jack_C2[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_jack_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="Simulacao_files/figure-html/unnamed-chunk-9-1.png" alt="Viés de cada estimativa de theta utilizando jackknife." width="768" />
<p class="caption">
Figure 3.8: Viés de cada estimativa de theta utilizando jackknife.
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="via-bootstrap" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Via Bootstrap</h2>
<p>O método bootstrap consiste em, dada uma amostra <span class="math inline">\(x\)</span> de tamanho <span class="math inline">\(n\)</span> (<span class="math inline">\(x_1, x_2, ..., x_n\)</span>), faça uma amostragem com reposição de <span class="math inline">\(x\)</span> com um mesmo tamanho <span class="math inline">\(n\)</span> e calcule novamente a estatística desejada (nesse caso, <span class="math inline">\(\hat{\theta}^\)</span>). Repita isso 500, 1000, 2000 ou número grande de vezes. A média de cada uma dessas estimativas de <span class="math inline">\(\hat{\theta}\)</span> será o estimador pontual bootstrap denotado por <span class="math inline">\(\hat{\theta}^B\)</span>. Um dos intervalos de confiança mais usados é o intervalo básico de bootstrap, que será o utilizado nesse estudo, mesmo que outros dois métodos estejam implementados na função abaixo. Mais informações sobre Bootstrap podem ser encontradas <a href="http://cursos.leg.ufpr.br/ce089/10_bootstrap.html">aqui</a>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="cf">function</span>(n, amostra, f, ...) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...: outros argumentos passados para f;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: vetor numérico com as estimativas de f aplicadas às amostras bootstraps</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(n, <span class="fu">f</span>(<span class="fu">sample</span>(amostra, <span class="at">replace =</span> T), ...))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimativa bootstrap corrigida</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>esttheta_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, thetas_boot, f, <span class="at">corr =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thetas_boot: vetor numérico com as estimativas bootstrap do parâmetro</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># corr: lógico que define se será calculada a estimativa corrigida</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...: demais argumentos passados para f</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: escalar com a estimativa bootstrap corrigida</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (corr) <span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(amostra, ...) <span class="sc">-</span> <span class="fu">mean</span>(thetas_boot) <span class="cf">else</span> <span class="fu">mean</span>(thetas_boot)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança bootstrap</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>boot_IC <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, thetas_boot, f, <span class="at">metodo =</span> <span class="st">&#39;basico&#39;</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.05</span>, ...) {</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thetas_boot: vetor numérico com as estimativas bootstrap do parâmetro</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># metodo: caractere informando o método de intervalo de confiança </span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   desejado. Possíveis valores são &#39;basico&#39;, &#39;percentil&#39; e &#39;normal&#39;.</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alpha: escalar com o nível de significância adotado. Padrão é 0.05</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: um vetor de comprimento 2 com os limites inferior e superior do IC</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span>(metodo,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;basico&#39;</span> <span class="ot">=</span> {<span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(amostra)<span class="sc">-</span><span class="fu">quantile</span>(thetas_boot, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, alpha<span class="sc">/</span><span class="dv">2</span>))},</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;percentil&#39;</span> <span class="ot">=</span> {<span class="fu">quantile</span>(thetas_boot, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))},</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;normal&#39;</span> <span class="ot">=</span> {<span class="fu">f</span>(amostra) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sd</span>(thetas_boot)})</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando Bootstrap ---------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>thetas_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, <span class="cf">function</span>(y) <span class="fu">boot</span>(<span class="dv">3000</span>, y, <span class="at">f =</span> esttheta)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>thetas_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, <span class="cf">function</span>(y) <span class="fu">boot</span>(<span class="dv">3000</span>, y, <span class="at">f =</span> esttheta)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativa pontual corrigida</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>est_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">amostra =</span> C1[[x]], <span class="at">thetas_boot =</span> thetas_boot_C1[[x]])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>est_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">amostra =</span> C2[[x]], <span class="at">thetas_boot =</span> thetas_boot_C2[[x]])</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>var_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(thetas_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, var))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>var_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(thetas_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, var))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo básico bootstrap para um nível de confiança de 95%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>IC_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(am, boots) {</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">boot_IC</span>(<span class="at">amostra =</span> am, <span class="at">thetas_boot =</span> boots, <span class="at">f =</span> esttheta, <span class="at">metodo =</span> <span class="st">&quot;basico&quot;</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">am =</span> C1[[x]], <span class="at">boots =</span> thetas_boot_C1[[x]])</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>IC_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(am, boots) {</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">boot_IC</span>(<span class="at">amostra =</span> am, <span class="at">thetas_boot =</span> boots, <span class="at">f =</span> esttheta, <span class="at">metodo =</span> <span class="st">&quot;basico&quot;</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">am =</span> C2[[x]], <span class="at">boots =</span> thetas_boot_C2[[x]])</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>contem_C1_boot <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_boot_C1[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>contem_C2_boot <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_boot_C2[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_boot, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_boot_C1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_boot,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Média&quot;</span>, <span class="st">&quot;Parâmetro&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;blue&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_boot, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_boot_C2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_boot,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="Simulacao_files/figure-html/unnamed-chunk-12-1.png" alt="Intervalos básicos de confiança 95% para diferentes tamanhos de amostra utilizando bootstrap." width="768" />
<p class="caption">
Figure 3.9: Intervalos básicos de confiança 95% para diferentes tamanhos de amostra utilizando bootstrap.
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>Veja que a taxa de cobertura do intervalo de confiança booststrap não é de 95% para pequenas amostras (Figura <a href="#fig:coberturaboot">3.10</a>). Porém à medida que o tamanho de amostra aumenta, a taxa de cobertura passa a equivaler o nível de confiança determinado.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cobertura_boot_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cobertura_boot_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_boot_C1, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_boot_C2, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    validos_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(a, length)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    validos_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(b, length)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    cobertura_boot_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a[validos_C1 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">sum</span>(validos_C1 <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    cobertura_boot_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b[validos_C2 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">sum</span>(validos_C2 <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_boot_C1, <span class="at">main =</span> <span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_boot_C2, <span class="at">main =</span> <span class="st">&quot;Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tamanho de amostra&quot;</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Taxa de Cobertura&quot;</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:coberturaboot"></span>
<img src="Simulacao_files/figure-html/coberturaboot-1.png" alt="Taxa de cobertura de IC utilizando intervalo básico de confiança para diferentes tamanhos de amostra e 1000 simulações de monte carlo." width="768" />
<p class="caption">
Figure 3.10: Taxa de cobertura de IC utilizando intervalo básico de confiança para diferentes tamanhos de amostra e 1000 simulações de monte carlo.
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<p>As Figuras <a href="#fig:viesboot">3.11</a> e <a href="#fig:viesboot2">3.12</a> apresentam o viés da estimativa boostrap com e sem <a href="http://cursos.leg.ufpr.br/ce089/10_bootstrap.html">correção para o viés</a>. Na Figura <a href="#fig:viesboot2">3.12</a> percebe-se que há um viés de subestimativa de <span class="math inline">\(\theta\)</span>, portanto a correção é necessária para uma estimativa não viesada de <span class="math inline">\(\theta\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>vies_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C1[[y]][[x]])))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>vies_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C2[[y]][[x]])))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C1[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Viés Médio&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Simulações&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C2[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:viesboot"></span>
<img src="Simulacao_files/figure-html/viesboot-1.png" alt="Viés de cada estimativa pontual corrigida de theta utilizando bootstrap." width="768" />
<p class="caption">
Figure 3.11: Viés de cada estimativa pontual corrigida de theta utilizando bootstrap.
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativa pontual NÃO corrigida</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>est_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">corr =</span> <span class="cn">FALSE</span>), <span class="at">amostra =</span> C1[[x]], <span class="at">thetas_boot =</span> thetas_boot_C1[[x]])</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>est_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">corr =</span> <span class="cn">FALSE</span>), <span class="at">amostra =</span> C2[[x]], <span class="at">thetas_boot =</span> thetas_boot_C2[[x]])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>vies_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C1[[y]][[x]])))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>vies_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C2[[y]][[x]])))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">&quot;theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C1[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Viés Médio&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;Simulações&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightgrey&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30&quot;</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">&quot;theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000&quot;</span>,</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C2[[x]], <span class="at">col =</span> <span class="st">&quot;lightgrey&quot;</span>))</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: c"><span style="display:block;" id="fig:viesboot2"></span>
<img src="Simulacao_files/figure-html/viesboot2-1.png" alt="Viés de cada estimativa não corrigida de theta utilizando bootstrap." width="768" />
<p class="caption">
Figure 3.12: Viés de cada estimativa não corrigida de theta utilizando bootstrap.
</p>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save.image(&#39;./imagem.RData&#39;)</span></span></code></pre></div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
