<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Agostini Orso">

<title>github.io.v2 - Geração de Números Aleatórios</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-THCB1Q3SM7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-THCB1Q3SM7', { 'anonymize_ip': true});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">github.io.v2</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cursos" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cursos</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cursos">    
        <li>
    <a class="dropdown-item" href="./colheita.html">
 <span class="dropdown-text">Colheita, Transporte e Logística Florestal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dendrometria.html">
 <span class="dropdown-text">Dendrometria</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./motores.html">
 <span class="dropdown-text">Motores, Máquinas e Implementos Florestais</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./silvtropical.html">
 <span class="dropdown-text">Silvicultura Tropical</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./ggplot.html"> 
<span class="menu-text">ggplot2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./MQO.html"> 
<span class="menu-text">MQO</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Simulacao.html" aria-current="page"> 
<span class="menu-text">Simulação</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introdução" id="toc-introdução" class="nav-link active" data-scroll-target="#introdução">INTRODUÇÃO</a>
  <ul class="collapse">
  <li><a href="#gerador-de-números-aleatórios" id="toc-gerador-de-números-aleatórios" class="nav-link" data-scroll-target="#gerador-de-números-aleatórios">Gerador de números aleatórios</a></li>
  </ul></li>
  <li><a href="#estimando-theta" id="toc-estimando-theta" class="nav-link" data-scroll-target="#estimando-theta">ESTIMANDO <span class="math inline">\(\theta\)</span></a>
  <ul class="collapse">
  <li><a href="#estimador-de-máxima-verossimilhança" id="toc-estimador-de-máxima-verossimilhança" class="nav-link" data-scroll-target="#estimador-de-máxima-verossimilhança">Estimador de máxima verossimilhança</a></li>
  <li><a href="#variância-do-estimador-de-máxima-verossimilhança" id="toc-variância-do-estimador-de-máxima-verossimilhança" class="nav-link" data-scroll-target="#variância-do-estimador-de-máxima-verossimilhança">Variância do estimador de máxima verossimilhança</a></li>
  <li><a href="#intevalo-de-confiança-baseado-na-razão-de-verossimilhança" id="toc-intevalo-de-confiança-baseado-na-razão-de-verossimilhança" class="nav-link" data-scroll-target="#intevalo-de-confiança-baseado-na-razão-de-verossimilhança">Intevalo de confiança baseado na razão de verossimilhança</a></li>
  </ul></li>
  <li><a href="#estudo-do-viés-e-cobertura-de-ic-para-theta." id="toc-estudo-do-viés-e-cobertura-de-ic-para-theta." class="nav-link" data-scroll-target="#estudo-do-viés-e-cobertura-de-ic-para-theta.">ESTUDO DO VIÉS E COBERTURA DE IC PARA <span class="math inline">\(\theta\)</span>.</a>
  <ul class="collapse">
  <li><a href="#via-máxima-verossimilhança" id="toc-via-máxima-verossimilhança" class="nav-link" data-scroll-target="#via-máxima-verossimilhança">Via Máxima Verossimilhança</a></li>
  <li><a href="#via-jackknife" id="toc-via-jackknife" class="nav-link" data-scroll-target="#via-jackknife">Via Jackknife</a></li>
  <li><a href="#via-bootstrap" id="toc-via-bootstrap" class="nav-link" data-scroll-target="#via-bootstrap">Via Bootstrap</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Geração de Números Aleatórios</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Agostini Orso </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introdução" class="level1">
<h1>INTRODUÇÃO</h1>
<p>Esse trabalho foi requisito para aprovação na disciplina <strong>CE089 - Estatística Computacional II</strong>, ofertada para o curso de Estatística da Universidade Federal do Paraná, e ministrada pelos professores Paulo Justiniano Ribeiro Júnior e Walmes Zeviani. O objetivo do trabalho foi gerar amostras aleatórias de uma certa distribuição de probabilidade com um parâmetro <span class="math inline">\(\theta\)</span>, e a partir dessas amostras realizar a estimativa pontual e intervalar de <span class="math inline">\(\hat{\theta}\)</span> via máxima verossimilhança, jackknife e bootstrap.</p>
<hr>
<p>Em linhas gerais, esses são os principais pontos do trabalho, que eu gostaria que o leitor se atentasse para os seguintes pontos:</p>
<ul>
<li><p>A geração de números aleatórios a partir do algoritmo de Metropolis-Hastings</p></li>
<li><p>O tamanho do intervalo de confiança é diferente para diferentes valores de <span class="math inline">\(\theta\)</span></p></li>
<li><p>O intervalo de confiança diminui à medida que aumenta o tamanho da amostra</p></li>
</ul>
<hr>
<p>A distribuição de probabilidade escolhida foi</p>
<span class="math display">\[\begin{equation}
F(x) = 1-e^{-x^2 \over 2\theta^2} \quad , \quad x &gt; 0 , \enspace  \theta &gt; 0
(\#eq:f)
\end{equation}\]</span>
<p>Veja que @ref(eq:f) já é a distribuição acumulada de <span class="math inline">\(x\)</span>. Já a densidade pode ser obtida derivando a função em relação a <span class="math inline">\(x\)</span>:</p>
<span class="math display">\[\begin{equation}
f(x) = {dF(x) \over dx} = {d \over dx} \Big[1-e^{-x^2 \over 2\theta^2} \Big] =  {x e^{ {-x^2 \over 2\theta^2}} \over \theta^2}
(\#eq:fder)
\end{equation}\]</span>
<p>Na @ref(fig:f2) estão apresentadas as curvas de densidade e acumuladas da distribuição escolhida para diferentes valores do parâmetro <span class="math inline">\(\theta\)</span>.</p>
<div class="cell" data-layout-align="c">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/f2-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Possíveis parametrizações da distribuição de probabilidade.</figcaption>
</figure>
</div>
</div>
</div>
<p>Veja que nosso objetivo é gerar valores de <span class="math inline">\(x\)</span> pertencentes à essa distribuição com um determinado valor de <span class="math inline">\(\theta\)</span> fixado, e a partir dessa amostra de <span class="math inline">\(x\)</span> <em>encontrar o valor de <span class="math inline">\(\theta\)</span> que foi usado para gerar esses dados</em>, denotado por <span class="math inline">\(\hat{\theta}\)</span>. Portanto <span class="math inline">\(\theta\)</span> se refere ao valor paramétrico, verdadeiro, aquele que gerou os dados, e <span class="math inline">\(\hat{\theta}\)</span> é a nossa estimativa do valor verdadeiro a partir dos dados. Como é uma estimativa, há uma incerteza associada à essa estimativa. Essa incerteza é a base dos intervalos de confiança.</p>
<p>Vamos tentar estimar o parâmetro <span class="math inline">\(\theta\)</span> e sua incerteza a partir de três métodos. O primeiro é a partir da máxima verossimilhança, o segundo a partir de jackknife, e o terceiro a partir de bootstrap. Também vamos repetir esse experimento inúmeras vezes e avaliar o comportamento da estimativa para um grande número de repetições, o que também caracteriza esse trabalho como um estudo de Monte Carlo.</p>
<hr>
<section id="gerador-de-números-aleatórios" class="level2">
<h2 class="anchored" data-anchor-id="gerador-de-números-aleatórios">Gerador de números aleatórios</h2>
<p>Como gerar números aleatórios dessa distribuição? no R, diversas distribuições de probabilidade possuem geradores de números aleatórios já implementados no pacote base: <code>rnorm()</code>, <code>rexp()</code>, <code>rchisq()</code>, etc. A distribuição desse trabalho, no entanto, não possui tal função implementada, e vamos utilizar um algoritmo chamado Metropolis-Hastings para amostrar dessa distribuição. Tudo que precisamos é a função densidade @ref(eq:fder).</p>
<p>De uma maneira resumida, o algoritmo de Metropolis-Hastings usa uma outra distribuição de probabilidade (chamada de <em>proposal</em>) para gerar amostras da distribuição desejada. Se certas condições forem satisfeitas, <a href="http://cursos.leg.ufpr.br/ce089/08_MCMC.html">com o tempo esse processo irá convergir para a distribuição estacionária de uma cadeia de Markov</a>, que não por acaso será a própria distribuição desejada. Veja que devemos ser capazes de gerar números aleatórios da <em>proposal</em> para que isso funcione. Aqui, utilizei uma distribuição qui-quadrado (<span class="math inline">\(\chi^2\)</span>) como <em>proposal</em>.</p>
<p>Como é uma cadeia de Markov que precisa entrar em estacionariedade, é comum no método “jogar fora” as amostras iniciais (burnin), de forma a só amostrar da distribuição quando o processo entrar em estacionariedade. Além disso, por ser um processo markoviano, cada amostra gerada não é independente da anterior, por isso também é comum aproveitar somente 1 a cada x amostras geradas (thinning) para amenizar essa dependência entre as observações.</p>
<p>Abaixo está minha implementação do algoritmo de Metropolis-Hastings para o problema.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proposal</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x, df, ...) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dchisq</span>(x, df, ...)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>rfun <span class="ot">&lt;-</span> <span class="cf">function</span>(n, theta, dprop, <span class="at">burnin =</span> <span class="dv">1000</span>, <span class="at">thinning =</span> <span class="dv">10</span>, <span class="at">x0 =</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    ...) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n: número de amostras geradas da distribuição</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theta: parâmetro da distribuição</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dprop: função densidade da distribuição proposta</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># burnin: número de amostras de aquecimento. O padrão é 1000</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># thinning: passo de seleção de amostras para amenizar a autocorrelação. O</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># padrão é 10</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x0: valor inicial da distribuição proposta. O padrão é rchisq(n = 1, df =</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 3)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...: demais argumentos passados para a função dprop</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(n <span class="sc">*</span> thinning <span class="sc">+</span> burnin)) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, x[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="fu">log</span>(<span class="fu">dfun</span>(y, theta)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">g</span>(x[i <span class="sc">-</span> <span class="dv">1</span>], y))) <span class="sc">-</span> (<span class="fu">log</span>(<span class="fu">dfun</span>(x[i <span class="sc">-</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>], theta)) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">g</span>(y, x[i <span class="sc">-</span> <span class="dv">1</span>]))))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;=</span> alpha) {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    xn <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>burnin)]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    xn <span class="ot">&lt;-</span> xn[<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">length</span>(xn), thinning)]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mcmc =</span> xn, <span class="at">k =</span> k<span class="sc">/</span>(n <span class="sc">*</span> thinning <span class="sc">+</span> burnin)))</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Na Figura @ref(fig:gna) há um exemplo comparando a distribuição teórica de parâmetro <span class="math inline">\(\theta = 40\)</span> com a distribuição empírica construída a partir de 10000 amostras geradas pelo algoritmo de Metropolis-Hastings. As curvas estão bem parecidas, então aparentemente o algoritmo funciona bem. O painel inferior direito da figura mostra a função de autocorrelação, e aparentemente um valor de raleio de 50 elimina a dependência entre observações.</p>
<p>Foi utilizado um burnin de 1000 amostras, e um thinning de 50. Isso quer dizer que as primeiras 1000 amostras geradas pelo algoritmo foram descartadas, e após isso, apenas uma amostra a cada 50 foi de fato utilizada. Em outras palavras, para ter uma amostra de tamanho 10000, precisamos gerar <span class="math inline">\(10000*50 + 1000 = 501000\)</span> valores da distribuição desejada.</p>
<div class="cell" data-layout-align="c">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/gna-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Comparação entre curvas empírica e teórica da distribuição para uma amostra de tamanho 10000.</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="estimando-theta" class="level1">
<h1>ESTIMANDO <span class="math inline">\(\theta\)</span></h1>
<section id="estimador-de-máxima-verossimilhança" class="level2">
<h2 class="anchored" data-anchor-id="estimador-de-máxima-verossimilhança">Estimador de máxima verossimilhança</h2>
<p>Para estimar <span class="math inline">\(\hat{\theta}\)</span> a partir dos dados, usarei o estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span>. O método de máxima verossimilhança basicamente nos responde a seguinte questão: dado que esses são os dados, qual seria o valor de <span class="math inline">\(\theta\)</span> <em>que torna mais provável a geração desses dados</em>? Mais informações podem ser obtidas <a href="http://www.leg.ufpr.br/~wagner/MCIE/Tutorial/TutorialII.html">aqui</a>.</p>
<p>As funções de verissimilhança <span class="math inline">\(L(x)\)</span> e log-verossimilhança <span class="math inline">\(lL(x)\)</span> são escritas como</p>
<span class="math display">\[\begin{equation}
L(x|\theta) = \displaystyle\prod_{i=1}^{n} { x_i e^{-x^2_i \over 2\theta^2} \over \theta^2} = {\displaystyle \prod_{i=1}^n x_i e^{-x^2_i \over 2\theta^2} \over \theta^{2n}}
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\label{eq:lL}
lL(\theta | x) = log(L(x|\theta)) = \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\theta^2} - 2n log(\theta)
\end{equation}\]</span>
<p>O estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span> é obtido a partir da derivada de <span class="math inline">\(lL(x)\)</span> em relação à <span class="math inline">\(\theta\)</span> e igualando a derivada a 0.</p>
<p><span class="math display">\[
U(\theta) = {d \over d\theta} [lL(\theta | x)] = {\displaystyle\sum_{i=1}^n x^2_i \over \theta^3} - {2n \over \theta}
\]</span></p>
<p><span class="math display">\[
{\displaystyle\sum_{i=1}^n x^2_i \over \hat{\theta}^3} - {2n \over \hat{\theta}} = 0
\]</span></p>
<span class="math display">\[\begin{equation}

\hat{\theta} = \Bigg( {\displaystyle\sum_{i=1}^n x^2_i \over 2n } \Bigg)^{1 \over 2}
(\#eq:esttheta)
\end{equation}\]</span>
<p>Ou seja, dado meu conjunto de dados <span class="math inline">\(x\)</span>, @ref(eq:esttheta) é o estimador de máxima verossimilhança de <span class="math inline">\(\theta\)</span>. Abaixo está sua implementação em R. Usarei essa função para estimar <span class="math inline">\(\hat{\theta}\)</span> ao longo do trabalho.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>esttheta <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, ...) (<span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(amostra)))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variância-do-estimador-de-máxima-verossimilhança" class="level2">
<h2 class="anchored" data-anchor-id="variância-do-estimador-de-máxima-verossimilhança">Variância do estimador de máxima verossimilhança</h2>
<p>A Variância do estimador é definida como <span class="math inline">\(V(\theta) = -I(\theta)^{-1}\)</span>. A informação observada de Fisher para essa distribuição é dada por</p>
<p><span class="math display">\[
I(\theta) = {d \over d\theta} [U(\theta)] = {-3\displaystyle \sum_{i=1}^n x^2_i \over \theta^4} + {2n \over \theta^2} = {-3\displaystyle\sum_{i=1}^n x^2_i + 2n\theta^2 \over \theta^4}
\]</span></p>
<span class="math display">\[\begin{equation}
V(\theta) = -I(\theta)^{-1} =  -\Bigg( {-3\displaystyle\sum_{i=1}^n x^2_i + 2n\theta^2 \over \theta^4}  \Bigg)^{-1} = { \theta^4 \over 3\displaystyle\sum_{i=1}^n x^2_i - 2n\theta^2 }
(\#eq:var)
\end{equation}\]</span>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vartheta <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, that, ...) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    that<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span>(<span class="dv">3</span> <span class="sc">*</span> <span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(amostra) <span class="sc">*</span> that<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aqui utilizei a informação observada, e não esperada, de Fisher. De qualquer forma, a variância do estimador não foi utilizada, pois o intervalo de confiança foi construído a partir da Deviance, apresentada abaixo.</p>
</section>
<section id="intevalo-de-confiança-baseado-na-razão-de-verossimilhança" class="level2">
<h2 class="anchored" data-anchor-id="intevalo-de-confiança-baseado-na-razão-de-verossimilhança">Intevalo de confiança baseado na razão de verossimilhança</h2>
<p>A deviance pode ser escrita como <span class="math inline">\(D(\theta) = -2log\big({L(\theta|x) \over L(\hat{\theta}|x)}\big)\)</span>, tal que <span class="math inline">\(D(\theta) \sim \chi^2_1\)</span>.</p>
<p><span class="math display">\[
D(\theta) = -2log\Bigg({L(\theta|x) \over L(\hat{\theta}|x)}\Bigg) = -2\Big[ lL(\theta) - lL(\hat{\theta}) \Big] =
\]</span></p>
<p><span class="math display">\[
-2 \Bigg[ \displaystyle \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\theta^2} - 2nlog(\theta) - \Bigg( \displaystyle \sum_{i=1}^n log(x_i) - {\displaystyle \sum_{i=1}^n x^2_i \over 2\hat{\theta}^2} - 2nlog(\hat{\theta}) \Bigg) \Bigg] =
\]</span></p>
<p><span class="math display">\[
-2 \Bigg[ {\displaystyle\sum_{i=1}^n x^2_i \over 2\hat{\theta}^2} - {\displaystyle\sum_{i=1}^n x^2_i \over 2\theta^2} + 2nlog(\hat{\theta}) - 2nlog(\theta)  \Bigg] = -2\Bigg[ {\displaystyle\sum_{i=1}^n x^2_i \over 2} \Bigg({1 \over \hat{\theta}^2} - {1 \over \theta^2} \Bigg) + 2nlog\Bigg({\hat{\theta} \over \theta} \Bigg) \Bigg]
\]</span></p>
<span class="math display">\[\begin{equation}
D(\theta) = \displaystyle\sum_{i=1}^n x^2_i \Bigg( {1 \over \theta^2} - {1 \over \hat{\theta}^2} \Bigg) - 4nlog\Bigg( {\hat{\theta} \over \theta} \Bigg)
(\#eq:deviance)
\end{equation}\]</span>
<p>Portanto os valores de <span class="math inline">\(\theta\)</span> que resultem em um valor extremo de <span class="math inline">\(D(\theta)\)</span> (sabendo que <span class="math inline">\(D(\theta) \sim \chi^2_1\)</span>), serão valores não contidos pelo intervalo de confiança (Figura @ref(fig:deviance)).</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>devtheta <span class="ot">&lt;-</span> <span class="cf">function</span>(t, that, amostra, ...) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(amostra<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>t<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>that<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">length</span>(amostra) <span class="sc">*</span> <span class="fu">log</span>(that<span class="sc">/</span>t)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">50</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">devtheta</span>(x, <span class="at">that =</span> <span class="dv">40</span>, <span class="fu">rfun</span>(<span class="dv">30</span>, <span class="dv">40</span>, g)<span class="sc">$</span>mcmc), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">50</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Deviance"</span>, <span class="at">main =</span> <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 40"</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">devtheta</span>(x, <span class="at">that =</span> <span class="dv">1</span>, <span class="fu">rfun</span>(<span class="dv">30</span>, <span class="dv">1</span>, g)<span class="sc">$</span>mcmc), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.5</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Deviance"</span>, <span class="at">main =</span> <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 1"</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/deviance-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Deviances para amostras de tamanho 30 utilizando valores de parâmetro 40 e 1. Os valores de theta cuja deviance esteja abaixo da linha vermelha estão contidos no intervalo de confiança.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="estudo-do-viés-e-cobertura-de-ic-para-theta." class="level1">
<h1>ESTUDO DO VIÉS E COBERTURA DE IC PARA <span class="math inline">\(\theta\)</span>.</h1>
<p>Foram considerados 2 cenários para a simulação:</p>
<ol type="1">
<li><p><span class="math inline">\(\theta = 40\)</span>;</p></li>
<li><p><span class="math inline">\(\theta = 1\)</span>.</p></li>
</ol>
<p>No entanto, em cada cenário foram geradas amostras aleatórias da distribuição escolhida de tamanhos 2 a 30, e depois de 50 a 1000 ao passo de 20, o que totaliza 77 tamanhos de amostra diferentes. De cada uma dessas amostras foram feitas a estimativa pontual do parâmetro (Equação @ref(eq:esttheta)) e delimitação do intervalo de confiança utilizando máxima verossimilhança, jackknife e bootstrap. Além disso, cada uma dessas etapas foi repetida 100 vezes, a fim de avaliar a taxa real de cobertura dos intervalos de confiança por cada método para cada cenário.</p>
<p>A Figura @ref(fig:densidades) apresenta a curva da densidade de probabilidade da função para os dois parâmetros escolhidos. Veja que quando <span class="math inline">\(\theta = 1\)</span>, a curva é muito mais assimétrica e com menor dispersão.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="st">"Densidade"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">40</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 1"</span>), <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 40"</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">text.col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">40</span>), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>), <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="st">"Densidade"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dfun</span>(x, <span class="at">theta =</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">add =</span> T)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 1"</span>), <span class="fu">expression</span>(theta <span class="sc">*</span> <span class="st">" = 40"</span>)),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.col =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/densidades-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Densidade da distribuição para os dois parâmetros testados.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(n, <span class="cf">function</span>(x) <span class="fu">rfun</span>(<span class="at">n =</span> x, <span class="at">theta =</span> par_C1, <span class="at">dprop =</span> g,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">thinning =</span> <span class="dv">50</span>)<span class="sc">$</span>mcmc))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(n, <span class="cf">function</span>(x) <span class="fu">rfun</span>(<span class="at">n =</span> x, <span class="at">theta =</span> par_C2, <span class="at">dprop =</span> g,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">thinning =</span> <span class="dv">50</span>)<span class="sc">$</span>mcmc))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativas de theta</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>that_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, esttheta))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>that_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, esttheta))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># médias de theta estimado para cada tamanho de amostra</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>media_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) that_C1[[y]][[x]])))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>media_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) that_C2[[y]][[x]])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Na Figura @ref(fig:simulacoes) estão os valores estimados de <span class="math inline">\(\hat{\theta}\)</span> para cada tamanho de amostra e cada uma das 100 realizações de monte carlo. Os paineis à esquerda são um recorte dos da direita, limitando a um tamanho de amostra entre 2 e 30. Veja que conforme aumenta o tamanho de amostra, há uma redução da variabilidade de <span class="math inline">\(\hat{\theta}\)</span>. Ou seja, passamos a ser mais <em>confiantes</em> da nossa estimativa conforme aumenta o tamanho da amostra.</p>
<p>Veja que também que a dispersão das linhas para <span class="math inline">\(\theta = 40\)</span> é maior que quando <span class="math inline">\(\theta = 1\)</span>. Veja também que de acordo com a equação @ref(eq:var), a variância do estimador depende de seu valor. Portanto maiores valores de <span class="math inline">\(\theta\)</span> incorrem em uma maior variabilidade em torno de si.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], that_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, that_C1[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, media_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Média"</span>, <span class="st">"Parâmetro"</span>, <span class="st">"Simulações"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"lightgrey"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], that_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, that_C2[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, media_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/simulacoes-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Estimativas de theta para cada tamanho de amostra e simulação de monte carlo.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="via-máxima-verossimilhança" class="level2">
<h2 class="anchored" data-anchor-id="via-máxima-verossimilhança">Via Máxima Verossimilhança</h2>
<p>A partir da função Deviance (Equação @ref(eq:deviance)), podemos calcular o intervalo de confiança da nossa estimativa <span class="math inline">\(\hat{\theta}\)</span> para cada uma das 100 realizações de Monte Carlo. A Figura @ref(fig:ICLL) mostra esses intervalos para a primeira realização de Monte Carlo. As barras vermelhas representam intervalos que não contiveram o valor verdadeiro (40 e 1, linha azul).</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando máxima verossimilhança -----------</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>var_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">vartheta</span>(<span class="at">amostra =</span> C1[[y]][[x]],</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">that =</span> that_C1[[y]][[x]])))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>var_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">vartheta</span>(<span class="at">amostra =</span> C2[[y]][[x]],</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">that =</span> that_C2[[y]][[x]])))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança de 95%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rootSolve)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>IC_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(j) {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(y) {</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        LI <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C1[[j]][[y]], <span class="at">amostra =</span> C1[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">lower =</span> <span class="fl">0.001</span>, <span class="at">upper =</span> that_C1[[j]][[y]])<span class="sc">$</span>root</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        LS <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C1[[j]][[y]], <span class="at">amostra =</span> C1[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">lower =</span> that_C1[[j]][[y]], <span class="at">upper =</span> <span class="dv">200</span>)<span class="sc">$</span>root</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">c</span>(LI, LS))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>IC_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(j) {</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(y) {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">uniroot.all</span>(<span class="at">f =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">devtheta</span>(<span class="at">t =</span> x, <span class="at">that =</span> that_C2[[j]][[y]], <span class="at">amostra =</span> C2[[j]][[y]]) <span class="sc">-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span>,</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        }, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="dv">5</span>))</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>contem_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>contem_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)), <span class="at">bg =</span> <span class="st">"black"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>],</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">2</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1, <span class="st">"green"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"red"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>, <span class="at">xlab =</span> <span class="cn">NA</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>]), <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C1[[<span class="dv">1</span>]],</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) x[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1, <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Média"</span>, <span class="st">"Parâmetro"</span>), <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"blue"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], media_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>],</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">2</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2, <span class="st">"green"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"red"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, media_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[<span class="dv">1</span>]), <span class="at">y1 =</span> <span class="fu">sapply</span>(IC_LL_C2[[<span class="dv">1</span>]],</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) x[<span class="dv">2</span>]), <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2, <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/ICLL-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Intervalos de confiança 95% para a primeira realização da simulação de monte carlo utilizando máxima verossimilhança.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para cada intervalo de confiança dessas figuras, existem outros 99 intervalos construídos via simulação. Como os intervalos são de 95% de confiança, espera-se que 95% dessas 100 realizações contenham o valor verdadeiro. Isso se chama taxa de cobertura do intervalo de confiança (quanto ele realmente é confiável).</p>
<p>A Figura @ref(fig:coberturaLL) apresenta a taxa de cobertura dos intervalos de confiança para os diferentes tamanhos de amostra. Aparentemente os intervalos possuem uma cobertura similar para todo os tamanhos de amostra, mas esse resultado não está muito de acordo com o que se vê na literatura, portanto deve ser verificado com mais calma.</p>
<div class="alert alert-danger" role="alert">
<p>
<strong>ATENÇÃO:</strong> Essa taxa de cobertura está estranha. a taxa de cobertura utilizando bootstrap é o comportamento esperado.
</p>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cobertura_LL_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cobertura_LL_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_LL_C1, <span class="st">"[["</span>, i)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_LL_C2, <span class="st">"[["</span>, i)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    cobertura_LL_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(a)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    cobertura_LL_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b[validos_C2 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(b)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_LL_C1, <span class="at">main =</span> <span class="fu">c</span>(<span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40"</span>), <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_LL_C2, <span class="at">main =</span> <span class="fu">c</span>(<span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1"</span>), <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/coberturaLL-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Taxa de cobertura dos Intervalos de confiança utilizando máxima verossimilhança para cada tamanho de amostra após 1000 simulações de monte carlo.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Já ná Figura @ref(fig:ViesLL) está o viés de estimativa dos parâmetros para os diferentes tamanhos de amostra. Aparentemente não foi identificado nenhum viés no estimador (lembrando que o estimador de máxima verossimilhança é assintoticamente não viesado).</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vies_LL_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(that_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vies_medio_LL_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_LL_C1[[y]][[x]])))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>vies_LL_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(that_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>vies_medio_LL_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_LL_C2[[y]][[x]])))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_LL_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_LL_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_LL_C1[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_LL_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Viés Médio"</span>, <span class="st">"0"</span>, <span class="st">"Simulações"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"lightgrey"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_LL_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_LL_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_LL_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_LL_C2[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_LL_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/ViesLL-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Viés médio e de cada simulação de monte carlo a partir do estimador de máxima verossimilhança.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="via-jackknife" class="level2">
<h2 class="anchored" data-anchor-id="via-jackknife">Via Jackknife</h2>
<p>Seja uma amostra de tamanho <span class="math inline">\(n = 20\)</span> (<span class="math inline">\(x_1, x_2, ..., x_n\)</span>), e seja um parâmetro <span class="math inline">\(\hat{\theta}\)</span> estimado a partir dessas n amostras. A estimativa pontual jackknife consiste em retirar uma observação (a i-ésima) e estimar novamente o parâmetro com as 19 observações restantes, denotado por <span class="math inline">\(\hat{\theta}^{(i)}\)</span>. Repita esse passo retirando uma a uma todas as 20 observações.</p>
<p><span class="math display">\[
\hat{\theta} = f(x_1, x_2, ..., x_n)
\]</span></p>
<p><span class="math display">\[
\hat{\theta}^{(i)} = f(x_1, x_2, ..., x_{i-1}, x_{i+1}, ..., x_n)
\]</span></p>
<p>A seguir, estime os chamados pseudo valores, denotados por <span class="math inline">\(\hat{\theta}^{*(i)}\)</span>, da seguinte forma</p>
<p><span class="math display">\[
\hat{\theta}^{*(i)} = n . \hat{\theta} - (n-1) . \hat{\theta}^{(i)}
\]</span></p>
<p>O estimador pontual jackknife <span class="math inline">\(\hat{\theta}^*\)</span> será a média dos pseudo valores</p>
<p><span class="math display">\[
\hat{\theta}^* = {\displaystyle\sum_{i=1}^n \hat{\theta}^{*(i)} \over n}
\]</span></p>
<p>O erro padrao do estimador jackknife é dado por</p>
<p><span class="math display">\[
EP[\hat{\theta}^*] = \sqrt{Var[\hat{\theta}^*] \over n}
\]</span></p>
<p>e seu intervalo de confinça pode ser aproximado por uma distribuição t de student se considerarmos que os pseudo valores são independentes. Mais informações sobre jackknife podem ser encontradas <a href="http://cursos.leg.ufpr.br/ce089/11_jackknife.html">aqui</a>.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>esttheta_jack <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, f, <span class="at">pseudo =</span> F, ...) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># amostra: vetor numérico com o conjunto de observações;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># f: função da estatística desejada para cálculo;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pseudo: lógico que indica se os pseudo valores devem ser retornados;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ...: outros argumentos passados para f;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ---</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># value: se pseudo = F, uma lista contendo a estimativa pontual de</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Jackknife e a variância estimada do estimador de Jackknife. Se pseudo =</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># T, uma lista igual à anterior mas acrescida dos pseudo valores.</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(amostra)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    par <span class="ot">&lt;-</span> <span class="fu">f</span>(amostra, ...)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">sapply</span>(i, <span class="cf">function</span>(x) <span class="fu">f</span>(amostra[<span class="sc">-</span>x], ...), <span class="at">simplify =</span> T)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    pseudovalores <span class="ot">&lt;-</span> n <span class="sc">*</span> par <span class="sc">-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> val</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    est <span class="ot">&lt;-</span> <span class="fu">mean</span>(pseudovalores)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">var</span>(pseudovalores)<span class="sc">/</span><span class="fu">length</span>(pseudovalores)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (pseudo) {</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">est =</span> est, <span class="at">var =</span> var, <span class="at">pseudo =</span> pseudovalores))</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">est =</span> est, <span class="at">var =</span> var))</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando Jackknife --------------</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimativa pontual</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>est_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>est))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>est_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>est))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>var_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>var))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>var_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) <span class="fu">esttheta_jack</span>(y, <span class="at">f =</span> esttheta)<span class="sc">$</span>var))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança de 95%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>IC_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(est, am, var) est <span class="sc">+</span> <span class="fu">c</span>(<span class="at">LI =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">LS =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(am) <span class="sc">-</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(var), <span class="at">est =</span> est_jack_C1[[x]], <span class="at">am =</span> C1[[x]], <span class="at">var =</span> var_jack_C1[[x]])</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>IC_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(est, am, var) est <span class="sc">+</span> <span class="fu">c</span>(<span class="at">LI =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">LS =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(am) <span class="sc">-</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(var), <span class="at">est =</span> est_jack_C2[[x]], <span class="at">am =</span> C2[[x]], <span class="at">var =</span> var_jack_C2[[x]])</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A @ref(fig:estjack) apresenta os intervalos de confiança para uma das 100 realizações de Monte Carlo. A taxa de cobertura (Figura @ref(fig:coberturajack)) mostra um padrão também não muito condizente com o que se vê na literatura.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>contem_C1_jack <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_jack_C1[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>contem_C2_jack <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_jack_C2[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_jack[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_jack_C1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_jack_C1[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_jack,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Média"</span>, <span class="st">"Parâmetro"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"blue"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_jack[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_jack_C2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_jack_C2[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_jack,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/estjack-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Intervalos de confiança 95% utilizando jackknife para a primeira simulação de monte carlo.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="alert alert-danger" role="alert">
<p>
<strong>ATENÇÃO:</strong> Essa taxa de cobertura está estranha. a taxa de cobertura utilizando bootstrap é o comportamento esperado.
</p>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cobertura_jack_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cobertura_jack_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_jack_C1, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_jack_C2, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    cobertura_jack_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(a)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    cobertura_jack_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">length</span>(b)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_jack_C1, <span class="at">main =</span> <span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40"</span>, <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_jack_C2, <span class="at">main =</span> <span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1"</span>, <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/coberturajack-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Taxa de cobertura de IC utilizando jackknife para 1000 simulações de monte carlo.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>vies_jack_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_jack_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>vies_medio_jack_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_jack_C1[[y]][[x]])))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>vies_jack_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_jack_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>vies_medio_jack_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_jack_C2[[y]][[x]])))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_jack_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_jack_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_jack_C1[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_jack_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Viés Médio"</span>, <span class="st">"0"</span>, <span class="st">"Simulações"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"lightgrey"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_jack_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_jack_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_jack_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_jack_C2[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_jack_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Viés de cada estimativa de theta utilizando jackknife.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="via-bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="via-bootstrap">Via Bootstrap</h2>
<p>O método bootstrap consiste em, dada uma amostra <span class="math inline">\(x\)</span> de tamanho <span class="math inline">\(n\)</span> (<span class="math inline">\(x_1, x_2, ..., x_n\)</span>), faça uma amostragem com reposição de <span class="math inline">\(x\)</span> com um mesmo tamanho <span class="math inline">\(n\)</span> e calcule novamente a estatística desejada (nesse caso, <span class="math inline">\(\hat{\theta}^\)</span>). Repita isso 500, 1000, 2000 ou número grande de vezes. A média de cada uma dessas estimativas de <span class="math inline">\(\hat{\theta}\)</span> será o estimador pontual bootstrap denotado por <span class="math inline">\(\hat{\theta}^B\)</span>. Um dos intervalos de confiança mais usados é o intervalo básico de bootstrap, que será o utilizado nesse estudo, mesmo que outros dois métodos estejam implementados na função abaixo. Mais informações sobre Bootstrap podem ser encontradas <a href="http://cursos.leg.ufpr.br/ce089/10_bootstrap.html">aqui</a>.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="cf">function</span>(n, amostra, f, ...) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...: outros argumentos passados para f;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: vetor numérico com as estimativas de f aplicadas às amostras bootstraps</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replicate</span>(n, <span class="fu">f</span>(<span class="fu">sample</span>(amostra, <span class="at">replace =</span> T), ...))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># estimativa bootstrap corrigida</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>esttheta_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, thetas_boot, f, <span class="at">corr =</span> <span class="cn">TRUE</span>, ...) {</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thetas_boot: vetor numérico com as estimativas bootstrap do parâmetro</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># corr: lógico que define se será calculada a estimativa corrigida</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...: demais argumentos passados para f</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: escalar com a estimativa bootstrap corrigida</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (corr) <span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(amostra, ...) <span class="sc">-</span> <span class="fu">mean</span>(thetas_boot) <span class="cf">else</span> <span class="fu">mean</span>(thetas_boot)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalos de confiança bootstrap</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>boot_IC <span class="ot">&lt;-</span> <span class="cf">function</span>(amostra, thetas_boot, f, <span class="at">metodo =</span> <span class="st">'basico'</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.05</span>, ...) {</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># amostra: vetor numérico com o conjunto de observações</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thetas_boot: vetor numérico com as estimativas bootstrap do parâmetro</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># f: função da estatística desejada para cálculo</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># metodo: caractere informando o método de intervalo de confiança </span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   desejado. Possíveis valores são 'basico', 'percentil' e 'normal'.</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alpha: escalar com o nível de significância adotado. Padrão é 0.05</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># value: um vetor de comprimento 2 com os limites inferior e superior do IC</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span>(metodo,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>         <span class="st">'basico'</span> <span class="ot">=</span> {<span class="dv">2</span><span class="sc">*</span><span class="fu">f</span>(amostra)<span class="sc">-</span><span class="fu">quantile</span>(thetas_boot, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, alpha<span class="sc">/</span><span class="dv">2</span>))},</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>         <span class="st">'percentil'</span> <span class="ot">=</span> {<span class="fu">quantile</span>(thetas_boot, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))},</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>         <span class="st">'normal'</span> <span class="ot">=</span> {<span class="fu">f</span>(amostra) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sd</span>(thetas_boot)})</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizando Bootstrap ---------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>thetas_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C1, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, <span class="cf">function</span>(y) <span class="fu">boot</span>(<span class="dv">3000</span>, y, <span class="at">f =</span> esttheta)))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>thetas_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(C2, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, <span class="cf">function</span>(y) <span class="fu">boot</span>(<span class="dv">3000</span>, y, <span class="at">f =</span> esttheta)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativa pontual corrigida</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>est_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">amostra =</span> C1[[x]], <span class="at">thetas_boot =</span> thetas_boot_C1[[x]])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>est_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">amostra =</span> C2[[x]], <span class="at">thetas_boot =</span> thetas_boot_C2[[x]])</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Variância de theta</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>var_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(thetas_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, var))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>var_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(thetas_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, var))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo básico bootstrap para um nível de confiança de 95%</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>IC_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(am, boots) {</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">boot_IC</span>(<span class="at">amostra =</span> am, <span class="at">thetas_boot =</span> boots, <span class="at">f =</span> esttheta, <span class="at">metodo =</span> <span class="st">"basico"</span>,</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">am =</span> C1[[x]], <span class="at">boots =</span> thetas_boot_C1[[x]])</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>IC_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(am, boots) {</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">boot_IC</span>(<span class="at">amostra =</span> am, <span class="at">thetas_boot =</span> boots, <span class="at">f =</span> esttheta, <span class="at">metodo =</span> <span class="st">"basico"</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">am =</span> C2[[x]], <span class="at">boots =</span> thetas_boot_C2[[x]])</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>contem_C1_boot <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_boot_C1[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>contem_C2_boot <span class="ot">&lt;-</span> <span class="fu">apply</span>(IC_boot_C2[[<span class="dv">1</span>]], <span class="dv">2</span>, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span> x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_boot, <span class="st">"green"</span>, <span class="st">"red"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_boot_C1[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_boot_C1[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C1_boot,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C1, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Média"</span>, <span class="st">"Parâmetro"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"blue"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], est_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta)))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">x1 =</span> n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y0 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">y1 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">2</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_boot, <span class="st">"green"</span>, <span class="st">"red"</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>])</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, est_boot_C2[[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> n, <span class="at">x1 =</span> n, <span class="at">y0 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">1</span>, ], <span class="at">y1 =</span> IC_boot_C2[[<span class="dv">1</span>]][<span class="dv">2</span>, ], <span class="at">col =</span> <span class="fu">ifelse</span>(contem_C2_boot,</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"green"</span>, <span class="st">"red"</span>))</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> par_C2, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Intervalos básicos de confiança 95% para diferentes tamanhos de amostra utilizando bootstrap.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veja que a taxa de cobertura do intervalo de confiança booststrap não é de 95% para pequenas amostras (Figura @ref(fig:coberturaboot)). Porém à medida que o tamanho de amostra aumenta, a taxa de cobertura passa a equivaler o nível de confiança determinado.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cobertura_boot_C1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(n))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cobertura_boot_C2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(<span class="fu">length</span>(n)))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_boot_C1, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">lapply</span>(IC_boot_C2, <span class="cf">function</span>(x) x[, i])</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    validos_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(a, length)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    validos_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(b, length)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    cobertura_boot_C1[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(a[validos_C1 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C1 <span class="sc">&amp;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C1), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">sum</span>(validos_C1 <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    cobertura_boot_C2[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(b[validos_C2 <span class="sc">==</span> <span class="dv">2</span>], <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">&lt;</span> par_C2 <span class="sc">&amp;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">2</span>] <span class="sc">&gt;</span> par_C2), <span class="at">na.rm =</span> T)<span class="sc">/</span><span class="fu">sum</span>(validos_C2 <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_boot_C1, <span class="at">main =</span> <span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 40"</span>, <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cobertura_boot_C2, <span class="at">main =</span> <span class="st">"Taxa de cobertura para</span><span class="sc">\n</span><span class="st">theta = 1"</span>, <span class="at">xlab =</span> <span class="st">"Tamanho de amostra"</span>,</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Taxa de Cobertura"</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.95</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/coberturaboot-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Taxa de cobertura de IC utilizando intervalo básico de confiança para diferentes tamanhos de amostra e 1000 simulações de monte carlo.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As Figuras @ref(fig:viesboot) e @ref(fig:viesboot2) apresentam o viés da estimativa boostrap com e sem <a href="http://cursos.leg.ufpr.br/ce089/10_bootstrap.html">correção para o viés</a>. Na Figura @ref(fig:viesboot2) percebe-se que há um viés de subestimativa de <span class="math inline">\(\theta\)</span>, portanto a correção é necessária para uma estimativa não viesada de <span class="math inline">\(\theta\)</span>.</p>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>vies_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C1[[y]][[x]])))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>vies_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C2[[y]][[x]])))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C1[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Viés Médio"</span>, <span class="st">"0"</span>, <span class="st">"Simulações"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"lightgrey"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C2[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/viesboot-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Viés de cada estimativa pontual corrigida de theta utilizando bootstrap.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="c">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimativa pontual NÃO corrigida</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>est_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">corr =</span> <span class="cn">FALSE</span>), <span class="at">amostra =</span> C1[[x]], <span class="at">thetas_boot =</span> thetas_boot_C1[[x]])</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>est_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) {</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapply</span>(<span class="cf">function</span>(amostra, thetas_boot) <span class="fu">esttheta_boot</span>(amostra, thetas_boot, <span class="at">f =</span> esttheta,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">corr =</span> <span class="cn">FALSE</span>), <span class="at">amostra =</span> C2[[x]], <span class="at">thetas_boot =</span> thetas_boot_C2[[x]])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>vies_boot_C1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C1, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C1))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C1[[y]][[x]])))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>vies_boot_C2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(est_boot_C2, <span class="cf">function</span>(x) <span class="fu">sapply</span>(x, <span class="cf">function</span>(y) y <span class="sc">-</span> par_C2))</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>vies_medio_boot_C2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n), <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(y) vies_boot_C2[[y]][[x]])))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n = 2:30"</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C1[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C1[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">40</span>, <span class="dv">40</span>), <span class="at">main =</span> <span class="st">"theta = 40</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C1[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Viés Médio"</span>, <span class="st">"0"</span>, <span class="st">"Simulações"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">1</span>,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"lightgrey"</span>), <span class="at">bg =</span> <span class="st">"transparent"</span>, <span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n = 2:30"</span>, <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(theta) <span class="sc">-</span> theta))</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_boot_C2[[x]][<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], vies_medio_boot_C2[<span class="dv">1</span><span class="sc">:</span><span class="dv">29</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>), <span class="at">main =</span> <span class="st">"theta = 1</span><span class="sc">\n</span><span class="st">n ~ 2:1000"</span>,</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="cn">NA</span>, <span class="at">ylab =</span> <span class="cn">NA</span>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>foo <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(x) <span class="fu">lines</span>(n, vies_boot_C2[[x]], <span class="at">col =</span> <span class="st">"lightgrey"</span>))</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, vies_medio_boot_C2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Simulacao_files/figure-html/viesboot2-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Viés de cada estimativa não corrigida de theta utilizando bootstrap.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save.image('./imagem.RData')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>