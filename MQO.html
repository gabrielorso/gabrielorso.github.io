<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Orso">

<title>github.io.v2 - Mínimos Quadrados Ordinários</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-THCB1Q3SM7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-THCB1Q3SM7', { 'anonymize_ip': true});
</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">github.io.v2</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cursos" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cursos</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cursos">    
        <li>
    <a class="dropdown-item" href="./colheita.html">
 <span class="dropdown-text">Colheita, Transporte e Logística Florestal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dendrometria.html">
 <span class="dropdown-text">Dendrometria</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./motores.html">
 <span class="dropdown-text">Motores, Máquinas e Implementos Florestais</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./silvtropical.html">
 <span class="dropdown-text">Silvicultura Tropical</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./ggplot.html"> 
<span class="menu-text">ggplot2</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./MQO.html" aria-current="page"> 
<span class="menu-text">MQO</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mínimos-quadrados-ordinários" id="toc-mínimos-quadrados-ordinários" class="nav-link active" data-scroll-target="#mínimos-quadrados-ordinários">Mínimos Quadrados Ordinários</a>
  <ul class="collapse">
  <li><a href="#derivada-parcial-em-relação-à-hatbeta_0" id="toc-derivada-parcial-em-relação-à-hatbeta_0" class="nav-link" data-scroll-target="#derivada-parcial-em-relação-à-hatbeta_0">Derivada parcial em relação à <span class="math inline">\(\hat{\beta_0}\)</span></a></li>
  <li><a href="#derivada-paricla-em-relação-à-hatbeta_1" id="toc-derivada-paricla-em-relação-à-hatbeta_1" class="nav-link" data-scroll-target="#derivada-paricla-em-relação-à-hatbeta_1">Derivada paricla em relação à <span class="math inline">\(\hat{\beta_1}\)</span></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mínimos Quadrados Ordinários</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Orso </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Utilizaremos o banco de dados <strong>trees</strong>. Esse banco de dados contém informações sobre o diâmetro em polegadas, altura em pés e volume em pés³ de 31 árvores <em>black cherry</em>.</p>
<p>Além disso, os gráficos serão gerados utilizando o pacote <code>ggplot2</code>, com comentários pertinentes sobre as funções utilizadas. Os comandos do pacote <code>ggplot2</code> são inseridos em camadas, normalmente iniciando por uma função que indica o banco de dados utilizado, e posteriormente as demais funções. As variáveis que serão utilizadas para criar os gráficos devem sempre estar “mapeadas” para serem encontradas, e a maneira de fazer isso é inserindo-as dentro do argumento <code>aes()</code>. No exemplo abaixo, o primeiro nível de comando especifica o banco de dados utilizado. O segundo indica o tipo de gráfico a ser criado e mapeia as variáveis de interesse. O terceiro comando introduz os títulos dos eixos, do gráfico, etc. E o quarto comando aplica um tema pronto ao gráfico. Para mais informações sobre pacote <code>ggplot</code>, acesse esse <a href="ggplot.html">breve tutorial</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"trees"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforma as variáveis para unidades comumente utilizadas</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> trees<span class="sc">$</span>Girth<span class="sc">/</span><span class="fl">2.54</span>     <span class="co"># polegadas para centímetros</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ht <span class="ot">&lt;-</span> trees<span class="sc">$</span>Height<span class="sc">/</span><span class="fl">3.281</span>  <span class="co"># pés para metros</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> trees<span class="sc">$</span>Volume<span class="sc">/</span><span class="fl">34.286</span>  <span class="co"># pés cúbicos para metros cúbicos</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>d2h <span class="ot">&lt;-</span> d<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>ht             </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 'd' é um vetor de diâmetros, e possui 31 elementos. Ou length(d)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3.267717 3.385827 3.464567 4.133858 4.212598 4.251969 4.330709 4.330709
 [9] 4.370079 4.409449 4.448819 4.488189 4.488189 4.606299 4.724409 5.078740
[17] 5.078740 5.236220 5.393701 5.433071 5.511811 5.590551 5.708661 6.299213
[25] 6.417323 6.811024 6.889764 7.047244 7.086614 7.086614 8.110236</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># O mesmo ocorre com ht, v e d2h.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Agrupa tudo em um único data frame</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d,ht,v,d2h)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>g.base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dados, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> d2h, <span class="at">y =</span> v)) <span class="sc">+</span>     <span class="co">#Introduz o dataframe utilizado</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co">#geom_point() cria gráfico de pontos</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"d2h"</span>,          <span class="co">#Adiciona Títulos dos eixos e do gráfico</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Volume (m³)"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Volume em função de d2h"</span>) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()                <span class="co">#Adiciona o tema Black and White</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MQO_files/figure-html/Banco de dados-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A figura acima demonstra a relação entre volume e <span class="math inline">\(d^2h\)</span>. Essa relação é conhecida no meio florestal através do modelo de Spurr: <span class="math inline">\(v = \beta_0 + \beta_1.d^2h\)</span>, e evidencia a relação linear entre as duas variáveis.</p>
<p>Para encontrar os parâmetros do modelo, basta utilizar a função <code>lm()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>spurr <span class="ot">&lt;-</span> <span class="fu">lm</span>(v <span class="sc">~</span> d2h, <span class="at">data =</span> dados)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spurr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = v ~ d2h, data = dados)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.13473 -0.03209 -0.00483  0.05090  0.12243 

Coefficients:
               Estimate  Std. Error t value            Pr(&gt;|t|)    
(Intercept) -0.00868224  0.02810346  -0.309                0.76    
d2h          0.00131156  0.00003673  35.711 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.07271 on 29 degrees of freedom
Multiple R-squared:  0.9778,    Adjusted R-squared:  0.977 
F-statistic:  1275 on 1 and 29 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(spurr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)          d2h 
-0.008682245  0.001311559 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>g.base <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Modelo de Spurr Ajustado"</span>) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(spurr)[<span class="dv">1</span>],  <span class="co">#Coeficiente linear  (b0)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> <span class="fu">coef</span>(spurr)[<span class="dv">2</span>],      <span class="co">#Coeficiente angular (b1)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"steelblue"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MQO_files/figure-html/linear simples-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Os valores de <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> encontrados foram de -0.0087 e 0.0013, respectivamente.</p>
<p>Agora vamos tentar chegar nos mesmos parâmetros realizando o método dos mínimos quadrados ordinários passo a passo.</p>
<section id="mínimos-quadrados-ordinários" class="level2">
<h2 class="anchored" data-anchor-id="mínimos-quadrados-ordinários">Mínimos Quadrados Ordinários</h2>
<p>O método dos mínimos quadrados ordinários é o principal método de estimativa dos parâmetros para regressões lineares, e tem como objetivo encontrar os parâmetros do modelo que resultem na menor soma de quadrados dos resíduos. Sua utilização depende de pressupostos. São eles:</p>
<ul>
<li><strong>1.</strong> Resíduos com média 0 e distribuição normal;</li>
<li><strong>2.</strong> Variância do erro constante;</li>
<li><strong>3.</strong> Independência dos resíduos.</li>
</ul>
<p>A formulação tradicional do modelo linear simples é exemplificada abaixo,</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1x + \epsilon
\]</span></p>
<p>Onde <span class="math inline">\(\beta_0\)</span> é o parâmetro linear, também chamado de intercepto ou constante, pois não depende de <span class="math inline">\(x\)</span>; <span class="math inline">\(\beta_1\)</span> é o parâmetro angular ou coeficiente da variável <span class="math inline">\(x\)</span>; <span class="math inline">\(\epsilon\)</span> é o erro, e representa a variação de <span class="math inline">\(y\)</span> que não é explicada pelo modelo. Outra formulação encontrada na literatura é <span class="math inline">\(y = \alpha + \beta x + \epsilon\)</span>.</p>
<p>Os valores estimados ou preditos da variável <span class="math inline">\(y\)</span> são denotados por <span class="math inline">\(\hat{y}\)</span>,</p>
<p><span class="math display">\[
\hat{y} = \hat{\beta_0} + \hat{\beta_1}x
\]</span></p>
<p>Os parâmetros <em>verdadeiros</em> <span class="math inline">\(\beta_i\)</span> do modelo são desconhecidos, e em vez disso se utiliza <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span> para definir os parâmetros <em>estimados</em> pela regressão.</p>
<p>O erro <span class="math inline">\(\epsilon\)</span> nada mais é que a diferença entre o valor real observado <span class="math inline">\(y\)</span>, e o valor estimado ou predito <span class="math inline">\(\hat{y}\)</span>.</p>
<p><span class="math display">\[
\epsilon_i = y_i - \hat{y_i}
\]</span></p>
<p>Como citado anteriormente, o objetivo do método é encontrar os parâmetros que resultem na menor soma de quadrados de resíduos (<span class="math inline">\(S\)</span>). Como os resíduos devem possuir média zero e distribuição normal, alguns resíduos são positivos e outros negativos. Nessa situação, a simples soma teria efeito de ‘compensação’ entre valores positivos e negativos, e o resultado final não representaria de forma apropriada o erro do modelo (o somatório seria próximo de zero). Ao elevar cada erro <span class="math inline">\(\epsilon\)</span> ao quadrado, temos uma melhor estimativa do erro a ser minimizado.</p>
<blockquote class="blockquote">
<p>O leitor mais rigoroso pode perceber que essa não é uma explicação suficiente para a dedução do método. Entretanto, esse pequeno texto busca atender também aqueles que estão iniciando seus estudos em estatística. Uma abordagem mais teórica pode ser obtida partindo da função de verossimilhança do modelo de regressão.</p>
</blockquote>
<p><span class="math display">\[
S = \sum_{i=1}^{n} \epsilon_i^2
\]</span></p>
<p>Com a substituição de alguns termos com as equações apresentadas acima, temos que</p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i - \hat{y_i})^2
\]</span></p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i - [\hat{\beta_0} + \hat{\beta_1}x_i])^2
\]</span></p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i - \hat{\beta_0} - \hat{\beta_1}x_i)^2
\]</span></p>
<p>Agora, se atribuíssemos algum valor qualquer para os parâmetros no modelo acima e calculássemos o somatório, isso resultaria em um valor <span class="math inline">\(S\)</span> de Soma de Quadrados de Resíduos. Conforme os valores dos parâmetros mudam, então também a Soma de Quadrados de Resíduos (<span class="math inline">\(S\)</span>) irá mudar.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cria uma função S que recebe os parâmetros x,y,a,b</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,b0,b1) {<span class="fu">sum</span>((y<span class="sc">-</span>b0<span class="sc">-</span>b1<span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Essa função criada recebe 4 argumentos: um vetor x, um vetor y, um valor de b0 e um valor de b1. Como x e y são dois vetores e b0 e b1 são dois valores, o que a função fará é realizar a operação y - b0 - b1*x para os primeiros valores de x e y e elevar o resultado ao quadrado. A seguir, realiza a mesma operação para os segundos valores e eleva o resultado ao quadrado. Por fim, é requisitado por meio da função sum() que faça o somatório de todos esses resultados. Por fim, isso resultará em um único valor que é a soma do quadrado dos resíduos para aquele par de coeficientes b0 e b1 informados.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Cria um vetor de possíveis valores de b0 e b1</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)  <span class="co">#De -0.5 até 0.5, ao passo de 0.01</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>b_1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Isso resulta em 101 valores diferentes de b0 e b1.</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(b_0) ; <span class="fu">length</span>(b_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cria vetor que receberá o resultado de S para cada possível valor de b0 e b1. Naturalmente, deve ter o mesmo comprimento do número de possíveis valores dos coeficientes.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>S.est <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(b_0))  <span class="co">#Vetor de comprimento igual ao vetor b0</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Cria um loop para estimar cada valor de S baseado em cada valor de b0 e b1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(S.est)) {</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  S.est[i] <span class="ot">&lt;-</span> <span class="fu">S</span>(<span class="at">x =</span> dados<span class="sc">$</span>d2h,  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> dados<span class="sc">$</span>v,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">b0 =</span> b_0[i],</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">b1 =</span> b_1[i])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#O comando acima pega a função S() criada acima, joga os primeiros valores de b0 e b1 dos vetores, calcula o valor de S e o guarda na primeira posição do vetor S.est. A seguir, pega todos valores das segundas posições dos vetores, joga na função S() criada e resgata o valor resultante, salvando na segunda posição do vetor S.est. Esse processo é repetido de 1:length(S.est), ou seja, do primeiro até o último valor dos vetores.</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Criando um data frame com as variáveis</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"b0"</span> <span class="ot">=</span> b_0,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"b1"</span> <span class="ot">=</span> b_1,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"S"</span> <span class="ot">=</span> S.est)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>g.S <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> b0, <span class="at">y =</span> S)) <span class="sc">+</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> S.est), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cria uma reta conectando cada observação. Como são 101 pontos, o resultado terá a forma de uma parábola.</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Parâmetro "</span><span class="sc">*</span>beta[<span class="dv">0</span>]), <span class="at">y =</span> <span class="st">"S (m³)²"</span>, <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="st">"Efeito de "</span><span class="sc">*</span>beta[<span class="dv">0</span>]<span class="sc">*</span><span class="st">" na Soma de Quadrado dos Resíduos"</span>)) <span class="sc">+</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">name =</span> <span class="st">"S (m³)²"</span>) <span class="sc">+</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">0.2</span>,<span class="at">xend=</span><span class="fl">0.2</span>, <span class="at">y =</span> <span class="fu">min</span>(S), <span class="at">yend =</span> <span class="fu">min</span>(S)), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g.S)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="MQO_files/figure-html/Variação de S-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Na figura acima, percebe-se que quando <span class="math inline">\(\hat{\beta_0}\)</span> é próximo de -0.5, a soma de quadrado dos resíduos é alta, assim como perto de 0.5. Entretanto, quando <span class="math inline">\(\hat{\beta_0}\)</span> é próximo de 0, S atinge os menores valores. Se fizéssemos esse procedimento com <span class="math inline">\(\hat{\beta_1}\)</span>, esse mesmo comportamento seria observado. Em outras palavras, existe um determinado valor de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span> que resultam no valor mínimo de S. Para encontrar os valores exatos, podemos fazer uso do cálculo diferencial.</p>
<p>Analisando a figura, percebemos que o ponto que resulta no menor valor de S é um ponto de mínima, e se trassarmos uma reta tangente à curva nesse ponto, essa reta será perfeitamente horizontal.</p>
<p>Uma maneira adequada para encontrar pontos críticos em uma função é utilizando cálculo diferencial, sabendo que nos pontos onde a primeira derivada for igual a zero, então a tangente da função será perfeitamente horizontal, marcando assim um ponto de máxima ou mínima.</p>
<p>Para encontrarmos os valores de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span> que minimizam S, precisamos derivar a função S em relação a esses parâmetros. Esse procedimento é chamado de derivada parcial (denotado por <span class="math inline">\(\partial\)</span>), e em linhas gerais tudo que não possuir relação com o parâmetro alvo é considerado como constante.</p>
<p>Primeiramente podemos abrir o polinômio da função <span class="math inline">\(S\)</span>.</p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i - \hat{\beta_0} - \hat{\beta_1}x_i)^2
\]</span></p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i^2 - y_i\hat{\beta_0} - y_i\hat{\beta_i}x_i-y_i\hat{\beta_0} + \hat{\beta_0}^2 + \hat{\beta_0}\hat{\beta_1}x_i - y_i\hat{\beta_1}x_i + \hat{\beta_0}\hat{\beta_1}x_i + \hat{\beta_1}^2x_i^2)
\]</span></p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} (y_i^2 + \hat{\beta_0}^2 + \hat{\beta_1}^2x_i^2 -2y_i\hat{\beta_0} - 2y_i\hat{\beta_1}x_i + 2\hat{\beta_0}\hat{\beta_1}x_i)
\]</span></p>
<hr>
<hr>
<section id="derivada-parcial-em-relação-à-hatbeta_0" class="level3">
<h3 class="anchored" data-anchor-id="derivada-parcial-em-relação-à-hatbeta_0">Derivada parcial em relação à <span class="math inline">\(\hat{\beta_0}\)</span></h3>
<p>As regras de derivação são as mesmas de qualquer outra diferenciação. A única diferença é que, agora, a variável de interesse é <span class="math inline">\(\hat{\beta_0}\)</span>, e tudo o mais é considerado constante.</p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_0}} = \sum_{i=1}^{n} (0 + \hat{\beta_0}^2 + 0 - 2y_i\hat{\beta_0} - 0 + 2\hat{\beta_0}\hat{\beta_1}x_i)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_0}} = \sum_{i=1}^{n} (0 + 2\hat{\beta_0} + 0 - 2y_i - 0 + 2\hat{\beta_1}x_i)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_0}} = \sum_{i=1}^{n} (2\hat{\beta_0} - 2y_i + 2\hat{\beta_1}x_i)
\]</span></p>
<p>Igualando a 0</p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_0}} = \sum_{i=1}^{n} (2\hat{\beta_0} - 2y_i + 2\hat{\beta_1}x_i) = 0
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_0}} = 2\sum_{i=1}^{n} (\hat{\beta_0} - y_i + \hat{\beta_1}x_i) = 0
\]</span></p>
<p>Podemos ainda realizar algumas simplificações.</p>
<p>Dividindo por 2 e multiplicando por -1</p>
<p><span class="math display">\[
\frac{\displaystyle  2\sum_{i=1}^{n} (\hat{\beta_0} - y_i + \hat{\beta_1}x_i)}{2} (-1) = \frac{0}{2}(-1)
\]</span></p>
<p><span class="math display">\[
\sum_{i=1}^{n} (y_i - \hat{\beta_0} - \hat{\beta_1}x_i) = 0
\]</span></p>
<p><span class="math display">\[
\sum_{i=1}^{n}y_i - n\hat{\beta_0} - n\hat{\beta_1}\sum_{i=1}^{n}x_i = 0
\]</span></p>
<p>Dividindo tudo por <span class="math inline">\(n\)</span></p>
<p><span class="math display">\[
\frac{\displaystyle  \sum_{i=1}^{n}y_i}{n} - \frac{\displaystyle  n\hat{\beta_0}}{n}-\frac{\displaystyle  n\hat{\beta_1}\sum_{i=1}^{n}x_i}{n} = \frac{0}{n}
\]</span></p>
<p><span class="math display">\[
\bar{y} - \hat{\beta_0} - \hat{\beta_1}\bar{x} = 0
\]</span></p>
<p>Com isso descobrimos que <span class="math inline">\(\displaystyle \frac{\partial S}{\partial \hat{\beta_0}}\)</span> vale 0 quando</p>
<p><span class="math display">\[
\hat{\beta_0} = \bar{y} - \hat{\beta_1}\bar{x}
\]</span></p>
<hr>
<hr>
</section>
<section id="derivada-paricla-em-relação-à-hatbeta_1" class="level3">
<h3 class="anchored" data-anchor-id="derivada-paricla-em-relação-à-hatbeta_1">Derivada paricla em relação à <span class="math inline">\(\hat{\beta_1}\)</span></h3>
<p>A derivada de <span class="math inline">\(S\)</span> em relação a <span class="math inline">\(\hat{\beta_1}\)</span> é</p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_1}} = \sum_{i=1}^{n} (0 + 0 + \hat{\beta_1}^2 x_i^2 - 0 - 2y_i\hat{\beta_1}x_i + 2\hat{\beta_0}\hat{\beta_1}x_i)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_1}} = \sum_{i=1}^{n} (0 + 0 + 2\hat{\beta_1}x_i^2 - 0 - 2y_ix_i + 2\hat{\beta_0}x_i)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_1}} = \sum_{i=1}^{n} (2\hat{\beta_1}x_i^2 - 2y_ix_i + 2\hat{\beta_0}x_i)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_1}} = 2\sum_{i=1}^{n} x_i(\hat{\beta_1}x_i - y_i + \hat{\beta_0})
\]</span></p>
<p>Essa é a derivada de S em relação a <span class="math inline">\(\hat{\beta_1}\)</span>. Agora igualamos a zero para encontrar o ponto de mínima.</p>
<p><span class="math display">\[
\frac{\partial S}{\partial \hat{\beta_1}} = 2\sum_{i=1}^{n} x_i(\hat{\beta_1}x_i - y_i + \hat{\beta_0}) = 0
\]</span></p>
<p>Dividindo por 2 para simplificação</p>
<p><span class="math display">\[
\frac{\displaystyle  2\sum_{i=1}^{n} x_i(\hat{\beta_1}x_i - y_i + \hat{\beta_0})}{2} = \frac{0}{2}
\]</span></p>
<p><span class="math display">\[
\sum_{i=1}^{n} x_i(\hat{\beta_1}x_i - y_i + \hat{\beta_0}) = 0
\]</span></p>
<p><span class="math display">\[
\sum_{i=1}^{n} x_i(-y_i + \hat{\beta_0} + \hat{\beta_1}x_i) = 0
\]</span></p>
<p><span class="math display">\[
-\sum_{i=1}^{n}x_iy_i + \hat{\beta_0} \sum_{i=1}^{n}x_i + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = 0
\]</span></p>
<p>Com isso descobrimos que <span class="math inline">\(\frac{\partial S}{\partial \hat{\beta_1}}\)</span> vale 0 quando</p>
<p><span class="math display">\[
\hat{\beta_0} \sum_{i=1}^{n}x_i + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = \sum_{i=1}^{n}x_iy_i
\]</span></p>
<hr>
<hr>
<p>Encontradas as derivadas, ainda falta resolvermos essas equações. A derivada de <span class="math inline">\(S\)</span> em relação à <span class="math inline">\(\hat{\beta_0}\)</span> ainda precisa de <span class="math inline">\(\hat{\beta_1}\)</span> para ser resolvida, e o mesmo ocorre para <span class="math inline">\(\hat{\beta_1}\)</span>.</p>
<p>Uma solução para isso é substituir o valor de <span class="math inline">\(\hat{\beta_0}\)</span> por <span class="math inline">\(\displaystyle \bar{y} - \hat{\beta_1}\bar{x}\)</span> na última equação apresentada acima. Essa substituição é valida pois estamos substituindo <span class="math inline">\(\hat{\beta_0}\)</span> pelo seu valor que garante um resultado 0 para sua derivada.</p>
<p>Substituindo o valor de <span class="math inline">\(\hat{\beta_0}\)</span> por <span class="math inline">\(\displaystyle \bar{y} - \hat{\beta_1}\bar{x}\)</span></p>
<p><span class="math display">\[
(\bar{y}-\hat{\beta_1}\bar{x})\sum_{i=1}^{n}x_i + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = \sum_{i=1}^{n}x_iy_i
\]</span></p>
<p>Como <span class="math inline">\(\bar{x} =\displaystyle \frac{\displaystyle \sum_{i=1}^{n}x_i}{n}\)</span>, então <span class="math inline">\(\displaystyle \sum_{i=1}^{n}x_i = n\bar{x}\)</span>.</p>
<p><span class="math display">\[
(\bar{y} - \hat{\beta_1}\bar{x}) n\bar{x} + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = \sum_{i=1}^{n}x_iy_i
\]</span></p>
<p><span class="math display">\[
n\bar{x}\bar{y} - \hat{\beta_1}n\bar{x}^2 + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = \sum_{i=1}^{n}x_iy_i
\]</span></p>
<p><span class="math display">\[
-\hat{\beta_1}n\bar{x}^2 + \hat{\beta_1}\sum_{i=1}^{n}x_i^2 = \sum_{i=1}^{n}x_iy_i - n\bar{x}\bar{y}
\]</span></p>
<p><span class="math display">\[
\hat{\beta_1}(\sum_{i=1}^{n}x_i^2 - n\bar{x}^2) = \sum_{i=1}^{n}x_iy_i - n\bar{x}\bar{y}
\]</span></p>
<p><span class="math display">\[
\hat{\beta_1} = \frac{\displaystyle \sum_{i=1}^{n}x_iy_i - n\bar{x}\bar{y}}{\displaystyle \sum_{i=1}^{n}x_i^2 - n\bar{x}^2} \qquad ou \qquad \hat{\beta_1} = \frac{\displaystyle \sum_{i=1}^{n}x_iy_i - \frac{\displaystyle \sum_{i=1}^{n}x_i\sum_{i=1}^{n}y_i}{n}}{\displaystyle \sum_{i=1}^{n}x_i^2 - \frac{\displaystyle (\sum_{i=1}^{n}x_i)^2}{n}}
\]</span></p>
<p>Agora, podemos encontrar o valor de <span class="math inline">\(\hat{\beta_1}\)</span> que garante o menor valor de <span class="math inline">\(S\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> d2h</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> v</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Serão chamados de b0.mqo e b1.mqo, para lembrarmos que são os valores obtido por meio das operações realizadas acima</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>b1.mqo <span class="ot">&lt;-</span> (<span class="fu">sum</span>(x<span class="sc">*</span>y)<span class="sc">-</span>(<span class="fu">sum</span>(x)<span class="sc">*</span><span class="fu">sum</span>(y))<span class="sc">/</span>n)<span class="sc">/</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>(<span class="fu">sum</span>(x)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>b0.mqo <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> b1.mqo<span class="sc">*</span><span class="fu">mean</span>(x)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>b0.mqo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.008682245</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>b1.mqo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001311559</code></pre>
</div>
</div>
<p>O caso mostrado acima foi montado com base na regressão linear simples, com somente os parâmetros <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>. O sistema de equações normais nesse caso é disposto da seguinte forma</p>
<p><span class="math display">\[
\begin{cases} \displaystyle  n\hat{\beta_0} \enspace \enspace \quad + \quad \hat{\beta_1}\sum_{i=1}^{n}x_i \quad = \quad \sum_{i=1}^{n}y_i \\
\displaystyle \hat{\beta_0}\sum_{i=1}^{n}x_i \quad + \quad \hat{\beta_1}\sum_{i=1}^{n}x_i^2 \quad = \quad \sum_{i=1}^{n}y_ix_i \end{cases}
\]</span></p>
<p>Para uma regressão linear múltipla, com mais de uma variável explicativa, o processo é similar, porém adicionando-se mais uma equações ao sistema.</p>
<p>Entretanto, quando muitas variáveis são adicionadas, convém dispor por meio de cálculo matricial. Essa disposição também é muito encontrada na literatura, e é comumente chamada de método análitico de resolução da regressão linear. As variáveis X, Y e os coeficientes assumem matrizes e vetores, como a seguir.</p>
<p><span class="math inline">\(\hat{\beta}\)</span> é o vetor de parâmetros do modelo, de dimensão <span class="math inline">\(p\times 1\)</span>. <span class="math inline">\(Y\)</span> é o vetor da variável observada. Tem dimensão <span class="math inline">\(n \times 1\)</span>. <span class="math inline">\(\epsilon\)</span> é o vetor de resíduos, de dimensão <span class="math inline">\(n \times 1\)</span>. <span class="math display">\[
\mathbf{\hat{\beta}} = \left[\begin{array}{c}
\hat{\beta_0} \\ \hat{\beta_1} \\ \vdots \\ \hat{\beta_p}
\end{array}\right]_{p\times 1} \qquad \mathbf{Y} = \left[\begin{array}{c}
y_1 \\ y_2 \\ \vdots \\ y_n
\end{array}\right]_{n \times 1} \qquad \mathbf{\epsilon} = \left[\begin{array}{c}
e_1 \\ e_2 \\ \vdots \\ e_n
\end{array}\right]_{n \times 1}
\]</span></p>
<p><span class="math inline">\(X\)</span> é a matriz das variáveis explicativas do modelo, onde <span class="math inline">\(n\)</span> é o número de observações, e <span class="math inline">\(p\)</span> é o número de parâmetros do modelo. <span class="math display">\[
\mathbf{X} = \left[\begin{array}
{cccc}   
1 &amp; X_{11} &amp; X_{12} &amp; \dots &amp; X_{1p} \\
1 &amp; X_{21} &amp; X_{22} &amp; \dots &amp; X_{2p} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; X_{n1} &amp; X_{n2} &amp; \dots &amp; X{np} \\
\end{array}\right]_{n \times p}
\]</span></p>
<p>Assim como no processo anterior, é desejado determinar o menor valor da soma de quadrado dos resíduos.</p>
<p><span class="math display">\[
S = \sum_{i=1}^{n} e_i^2 = \epsilon^\top \epsilon
\]</span></p>
<p><span class="math display">\[
\epsilon^\top \epsilon = (Y - \hat{\beta}X)^\top (Y - X\hat{\beta})
\]</span></p>
<p><span class="math display">\[
= Y^\top Y - Y^\top (X\hat{\beta}) - (X\hat{\beta})^\top Y + (X\hat{\beta})^\top (X\hat{\beta})
\]</span> <span class="math display">\[
= Y^\top Y - (X\hat{\beta})^\top Y - (X\hat{\beta})^\top Y + (X\hat{\beta})^\top (X\hat{\beta})
\]</span> <span class="math display">\[
= Y^\top Y - 2(X\hat{\beta})^\top Y + (X\hat{\beta})^\top (X\hat{\beta})
\]</span> <span class="math display">\[
\mathbf{S} = Y^\top Y - 2\hat{\beta}^\top X^\top Y + \hat{\beta}^\top X^\top X \hat{\beta}
\]</span></p>
<p>A derivada parcial é dada por</p>
<p><span class="math display">\[
\frac{\partial}{\partial \hat{\beta}}[\epsilon^\top \epsilon] = 0 \enspace - \enspace 2\hat{\beta}^\top X^\top Y \enspace + \enspace \hat{\beta}^\top X^\top X\hat{\beta} \enspace = \enspace 0
\]</span></p>
<p><span class="math display">\[
0 - 2X^\top Y + 2X^\top X\hat{\beta} = 0
\]</span></p>
<p><span class="math display">\[
2X^\top X\hat{\beta} = 2X^\top Y
\]</span></p>
<p><span class="math display">\[
X^\top X\hat{\beta} = X^\top Y
\]</span></p>
<p><span class="math display">\[
\mathbf{\hat{\beta}} = (X^\top X)^{-1} X^\top Y
\]</span></p>
<p>Essa é a equação que garante o menor valor de <span class="math inline">\(S\)</span>. Também podemos utilizá-la para encontrar os parâmetros.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(y <span class="sc">~</span> x)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>betas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    [,1]
(Intercept) -0.008682245
x            0.001311559</code></pre>
</div>
</div>
<p>E só para termos certeza de que tudo foi feito corretamente.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)            x 
-0.008682245  0.001311559 </code></pre>
</div>
</div>
<p>As três tentativas garantem o mesmo resultado.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-condensed table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MQO</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MQO_Mat</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">B0</td>
<td style="text-align: right;">-0.0086822</td>
<td style="text-align: right;">-0.0086822</td>
<td style="text-align: right;">-0.0086822</td>
</tr>
<tr class="even">
<td style="text-align: left;">B1</td>
<td style="text-align: right;">0.0013116</td>
<td style="text-align: right;">0.0013116</td>
<td style="text-align: right;">0.0013116</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Esse é o método dos mínimos quadrados.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>